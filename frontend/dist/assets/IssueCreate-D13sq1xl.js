import{_ as A,D as N,E,U as F,j as D,k as M,c as s,o as a,a as e,m as x,n as h,N as U,l as f,t as n,J as i,K as u,F as z,s as P,V as L,p as j,u as b,v as q,H as R,w as T,y as O,z as B,C as X}from"./index-ChsQcVH8.js";const H={name:"IssueCreate",components:{ArrowLeftIcon:M,GiftIcon:D,MagnifyingGlassIcon:F,XMarkIcon:E,ArrowPathIcon:N},setup(){const _=X(),t=O(),{showNotification:y}=B(),r=b(!1),c=b({}),v=b(""),m=b([]),p=b(null),d=q({gift:"",recipient_name:"",recipient_email:"",recipient_phone:"",recipient_organization:"",delivery_address:"",issue_date:new Date().toISOString().split("T")[0],reference_id:"",notes:"",send_email:!0,email_message:""}),w=R(()=>{if(!v.value)return m.value;const l=v.value.toLowerCase();return m.value.filter(g=>g.gift_name.toLowerCase().includes(l)||g.gift_code.toLowerCase().includes(l)||g.category.toLowerCase().includes(l))}),k=async()=>{try{m.value=[{name:"GIFT-001",gift_name:"Premium Spa Voucher",gift_code:"SPA-2025-001",category:"service",value:500},{name:"GIFT-002",gift_name:"Dubai Mall Shopping Card",gift_code:"SHOP-2025-002",category:"voucher",value:1e3},{name:"GIFT-003",gift_name:"Desert Safari Experience",gift_code:"SAFARI-2025-003",category:"experience",value:300}];const l=t.query.gift;if(l){const g=m.value.find(V=>V.name===l);g&&o(g)}}catch(l){console.error("Failed to load gifts:",l),y("Failed to load available gifts","error")}},o=l=>{p.value=l,d.gift=l.name,c.value.gift=""},I=()=>{p.value=null,d.gift=""},G=()=>(c.value={},d.gift||(c.value.gift="Please select a gift to issue"),d.recipient_name.trim()||(c.value.recipient_name="Recipient name is required"),d.recipient_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.recipient_email)||(c.value.recipient_email="Please enter a valid email address"):c.value.recipient_email="Recipient email is required",d.issue_date||(c.value.issue_date="Issue date is required"),Object.keys(c.value).length===0),C=async()=>{if(G())try{r.value=!0,await new Promise(l=>setTimeout(l,2e3)),y("Gift issued successfully","success"),_.push("/issues")}catch(l){console.error("Failed to create issue:",l),y("Failed to issue gift. Please try again.","error")}finally{r.value=!1}},S=l=>new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED"}).format(l||0);return T(()=>{k()}),{form:d,errors:c,loading:r,giftSearch:v,availableGifts:m,preselectedGift:p,filteredGifts:w,selectGift:o,clearGiftSelection:I,createIssue:C,formatCurrency:S}}},J={class:"min-h-full bg-desert-sand-50"},K={class:"bg-white shadow-card"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},W={class:"flex items-center justify-between"},Y={class:"flex items-center space-x-4"},Z={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},$={class:"bg-white rounded-xl shadow-card p-6"},ee={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},te={class:"flex items-center space-x-4"},re={class:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},oe={class:"flex-1"},se={class:"font-medium text-charcoal-900"},ae={class:"text-sm text-charcoal-600"},le={key:1},ne={class:"space-y-4"},ie={class:"relative"},ce={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},de={class:"max-h-64 overflow-y-auto border border-charcoal-200 rounded-lg"},fe={key:0,class:"p-4 text-center text-charcoal-600"},ue={key:1},me=["onClick"],pe={class:"flex items-center space-x-4"},ge={class:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center"},xe={class:"flex-1"},he={class:"font-medium text-charcoal-900"},be={class:"flex items-center space-x-2 text-sm text-charcoal-600"},_e={class:"capitalize"},ye={class:"font-medium text-gray-700"},ve={key:2,class:"mt-2 text-sm text-red-600"},we={class:"bg-white rounded-xl shadow-card p-6"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ie={key:0,class:"mt-1 text-sm text-red-600"},Ge={key:0,class:"mt-1 text-sm text-red-600"},Ce={key:0,class:"mt-1 text-sm text-red-600"},Se={key:0,class:"mt-1 text-sm text-red-600"},Ve={class:"mt-6"},Ae={key:0,class:"mt-1 text-sm text-red-600"},Ne={class:"bg-white rounded-xl shadow-card p-6"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Fe={key:0,class:"mt-1 text-sm text-red-600"},De={key:0,class:"mt-1 text-sm text-red-600"},Me={class:"mt-6"},Ue={key:0,class:"mt-1 text-sm text-red-600"},ze={class:"bg-white rounded-xl shadow-card p-6"},Pe={class:"space-y-4"},Le={class:"flex items-center justify-between"},je={class:"relative inline-flex items-center cursor-pointer"},qe={key:0,class:"pl-4 border-l-2 border-gray-200"},Re={class:"flex items-center justify-end space-x-4 pt-6"},Te=["disabled"],Oe={key:0,class:"flex items-center"},Be={key:1};function Xe(_,t,y,r,c,v){const m=h("ArrowLeftIcon"),p=h("GiftIcon"),d=h("XMarkIcon"),w=h("MagnifyingGlassIcon"),k=h("ArrowPathIcon");return a(),s("div",J,[e("div",K,[e("div",Q,[e("div",W,[e("div",Y,[e("button",{onClick:t[0]||(t[0]=o=>_.$router.push("/issues")),class:"p-2 rounded-lg text-charcoal-600 hover:bg-charcoal-100 transition-colors"},[x(m,{class:"w-5 h-5"})]),t[15]||(t[15]=e("div",null,[e("h1",{class:"text-2xl lg:text-3xl font-bold text-charcoal-900"}," Issue New Gift "),e("p",{class:"text-charcoal-600"},"Create a new gift issue for a recipient")],-1))])])])]),e("div",Z,[e("form",{onSubmit:t[14]||(t[14]=U((...o)=>r.createIssue&&r.createIssue(...o),["prevent"])),class:"space-y-8"},[e("div",$,[t[19]||(t[19]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Gift Selection",-1)),r.preselectedGift?(a(),s("div",ee,[e("div",te,[e("div",re,[x(p,{class:"w-6 h-6 text-gray-700"})]),e("div",oe,[e("h3",se,n(r.preselectedGift.gift_name),1),e("p",ae,n(r.preselectedGift.gift_code)+" • "+n(r.formatCurrency(r.preselectedGift.value)),1)]),e("button",{type:"button",onClick:t[1]||(t[1]=(...o)=>r.clearGiftSelection&&r.clearGiftSelection(...o)),class:"text-charcoal-500 hover:text-charcoal-700"},[x(d,{class:"w-5 h-5"})])])])):(a(),s("div",le,[e("div",ne,[e("div",null,[t[16]||(t[16]=e("label",{for:"gift_search",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Search Gifts ",-1)),e("div",ie,[e("div",ce,[x(w,{class:"w-5 h-5 text-charcoal-400"})]),i(e("input",{id:"gift_search","onUpdate:modelValue":t[2]||(t[2]=o=>r.giftSearch=o),type:"text",class:"w-full pl-10 pr-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Search by name, code, or category..."},null,512),[[u,r.giftSearch]])])]),e("div",de,[r.availableGifts.length===0?(a(),s("div",fe," No available gifts found ")):(a(),s("div",ue,[(a(!0),s(z,null,P(r.filteredGifts,o=>(a(),s("div",{key:o.name,onClick:I=>r.selectGift(o),class:"p-4 border-b border-charcoal-200 last:border-b-0 hover:bg-desert-sand-50 cursor-pointer transition-colors"},[e("div",pe,[e("div",ge,[x(p,{class:"w-5 h-5 text-gray-700"})]),e("div",xe,[e("h4",he,n(o.gift_name),1),e("div",be,[e("span",null,n(o.gift_code),1),t[17]||(t[17]=e("span",null,"•",-1)),e("span",_e,n(o.category),1),t[18]||(t[18]=e("span",null,"•",-1)),e("span",ye,n(r.formatCurrency(o.value)),1)])])])],8,me))),128))]))])])])),r.errors.gift?(a(),s("p",ve,n(r.errors.gift),1)):f("",!0)]),e("div",we,[t[25]||(t[25]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Recipient Information",-1)),e("div",ke,[e("div",null,[t[20]||(t[20]=e("label",{for:"recipient_name",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Full Name * ",-1)),i(e("input",{id:"recipient_name","onUpdate:modelValue":t[3]||(t[3]=o=>r.form.recipient_name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter recipient's full name"},null,512),[[u,r.form.recipient_name]]),r.errors.recipient_name?(a(),s("p",Ie,n(r.errors.recipient_name),1)):f("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{for:"recipient_email",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Email Address * ",-1)),i(e("input",{id:"recipient_email","onUpdate:modelValue":t[4]||(t[4]=o=>r.form.recipient_email=o),type:"email",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter recipient's email"},null,512),[[u,r.form.recipient_email]]),r.errors.recipient_email?(a(),s("p",Ge,n(r.errors.recipient_email),1)):f("",!0)]),e("div",null,[t[22]||(t[22]=e("label",{for:"recipient_phone",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Phone Number ",-1)),i(e("input",{id:"recipient_phone","onUpdate:modelValue":t[5]||(t[5]=o=>r.form.recipient_phone=o),type:"tel",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"+971 50 123 4567"},null,512),[[u,r.form.recipient_phone]]),r.errors.recipient_phone?(a(),s("p",Ce,n(r.errors.recipient_phone),1)):f("",!0)]),e("div",null,[t[23]||(t[23]=e("label",{for:"recipient_organization",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Organization ",-1)),i(e("input",{id:"recipient_organization","onUpdate:modelValue":t[6]||(t[6]=o=>r.form.recipient_organization=o),type:"text",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter organization name (optional)"},null,512),[[u,r.form.recipient_organization]]),r.errors.recipient_organization?(a(),s("p",Se,n(r.errors.recipient_organization),1)):f("",!0)])]),e("div",Ve,[t[24]||(t[24]=e("label",{for:"delivery_address",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Delivery Address ",-1)),i(e("textarea",{id:"delivery_address","onUpdate:modelValue":t[7]||(t[7]=o=>r.form.delivery_address=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter delivery address (optional)"},null,512),[[u,r.form.delivery_address]]),r.errors.delivery_address?(a(),s("p",Ae,n(r.errors.delivery_address),1)):f("",!0)])]),e("div",Ne,[t[29]||(t[29]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Issue Details",-1)),e("div",Ee,[e("div",null,[t[26]||(t[26]=e("label",{for:"issue_date",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Issue Date * ",-1)),i(e("input",{id:"issue_date","onUpdate:modelValue":t[8]||(t[8]=o=>r.form.issue_date=o),type:"date",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"},null,512),[[u,r.form.issue_date]]),r.errors.issue_date?(a(),s("p",Fe,n(r.errors.issue_date),1)):f("",!0)]),e("div",null,[t[27]||(t[27]=e("label",{for:"reference_id",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Reference ID ",-1)),i(e("input",{id:"reference_id","onUpdate:modelValue":t[9]||(t[9]=o=>r.form.reference_id=o),type:"text",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter reference ID (optional)"},null,512),[[u,r.form.reference_id]]),r.errors.reference_id?(a(),s("p",De,n(r.errors.reference_id),1)):f("",!0)])]),e("div",Me,[t[28]||(t[28]=e("label",{for:"notes",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Notes ",-1)),i(e("textarea",{id:"notes","onUpdate:modelValue":t[10]||(t[10]=o=>r.form.notes=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter any notes about this gift issue (optional)"},null,512),[[u,r.form.notes]]),r.errors.notes?(a(),s("p",Ue,n(r.errors.notes),1)):f("",!0)])]),e("div",ze,[t[33]||(t[33]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Notification Settings",-1)),e("div",Pe,[e("div",Le,[t[31]||(t[31]=e("div",null,[e("h3",{class:"text-base font-medium text-charcoal-900"},"Send Email Notification"),e("p",{class:"text-sm text-charcoal-600"},"Send gift details to recipient's email")],-1)),e("label",je,[i(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>r.form.send_email=o),type:"checkbox",class:"sr-only peer"},null,512),[[L,r.form.send_email]]),t[30]||(t[30]=e("div",{class:"w-11 h-6 bg-charcoal-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-gray-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-charcoal-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-600"},null,-1))])]),r.form.send_email?(a(),s("div",qe,[t[32]||(t[32]=e("label",{for:"email_message",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Custom Message ",-1)),i(e("textarea",{id:"email_message","onUpdate:modelValue":t[12]||(t[12]=o=>r.form.email_message=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Add a personal message to the email (optional)"},null,512),[[u,r.form.email_message]])])):f("",!0)])]),e("div",Re,[e("button",{type:"button",onClick:t[13]||(t[13]=o=>_.$router.push("/issues")),class:"px-6 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:r.loading,class:"px-6 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gray-600 hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[r.loading?(a(),s("span",Oe,[x(k,{class:"w-4 h-4 mr-2 animate-spin"}),t[34]||(t[34]=j(" Creating Issue... ",-1))])):(a(),s("span",Be,"Issue Gift"))],8,Te)])],32)])])}const Je=A(H,[["render",Xe],["__scopeId","data-v-42ef0799"]]);export{Je as default};
