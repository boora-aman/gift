var u=(a,e,d)=>new Promise((g,s)=>{var i=y=>{try{x(d.next(y))}catch(r){s(r)}},m=y=>{try{x(d.throw(y))}catch(r){s(r)}},x=y=>y.done?g(y.value):Promise.resolve(y.value).then(i,m);x((d=d.apply(a,e)).next())});import{_ as D,r as P,b as N,d as C,e as f,c as n,o as l,a as t,w as p,v as h,f as c,t as o,g as I,h as R,i as S,j as b,F as _,k,n as w,R as v}from"./index-DXfJHqnU.js";import{u as E}from"./useToast-Dqmum05C.js";import{e as G}from"./exportUtils-rTjg8JsQ.js";const T={name:"DispatchedGiftsReport",components:{ArrowDownTrayIcon:C,ArrowUpIcon:N,ArrowDownIcon:P},setup(){const{showToast:a}=E();return{showToast:a}},data(){return{loading:!1,isExporting:!1,reportData:[],totalRecords:0,currentPage:1,totalPages:1,pageSize:20,sortBy:"creation",sortOrder:"desc",filters:{giftId:"",giftName:"",personaDetails:""}}},computed:{visiblePages(){const a=[];let d=Math.max(1,this.currentPage-Math.floor(2.5)),g=Math.min(this.totalPages,d+5-1);g-d+1<5&&(d=Math.max(1,g-5+1));for(let s=d;s<=g;s++)a.push(s);return a}},mounted(){this.loadReport()},methods:{loadReport(){return u(this,null,function*(){this.loading=!0;try{const a={page:this.currentPage,limit:this.pageSize,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(a).forEach(d=>{a[d]||delete a[d]});const e=yield v.getDispatchedGiftsReport(a);if(e.success)this.reportData=e.data,this.totalRecords=e.total,this.totalPages=e.totalPages;else throw new Error(e.error)}catch(a){console.error("Error loading report:",a),this.showToast("Failed to load report: "+a.message,"error")}finally{this.loading=!1}})},exportReport(){return u(this,null,function*(){this.isExporting=!0;try{const a={limit:1e4,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(a).forEach(g=>{a[g]||delete a[g]});const e=yield v.getDispatchedGiftsReport(a);if(!e.success)throw new Error(e.error);const d=[{key:"gift_id",title:"Gift Code"},{key:"gift_name",title:"Gift Name"},{key:"category",title:"Category"},{key:"barcode_value",title:"Barcode"},{key:"gift_value",title:"Gift Value"},{key:"owner_full_name",title:"Owner Name"},{key:"coordinator_full_name",title:"Coordinator Name"},{key:"emirates_id",title:"Emirates ID"},{key:"mobile_number",title:"Mobile Number"},{key:"address",title:"Address"},{key:"dispatch_date",title:"Dispatch Date"},{key:"delivery_status",title:"Delivery Status"},{key:"delivery_date",title:"Delivery Date"},{key:"delivery_note",title:"Delivery Note"},{key:"creator_name",title:"Created By"}];G(e.data,d,"Dispatched_Gifts_Report"),this.showToast("Report exported successfully","success")}catch(a){console.error("Export error:",a),this.showToast("Failed to export report: "+a.message,"error")}finally{this.isExporting=!1}})},applyFilters(){this.currentPage=1,this.loadReport()},clearFilters(){this.filters={giftId:"",giftName:"",personaDetails:""},this.applyFilters()},toggleSortOrder(){this.sortOrder=this.sortOrder==="asc"?"desc":"asc",this.applyFilters()},goToPage(a){a>=1&&a<=this.totalPages&&(this.currentPage=a,this.loadReport())},formatDate(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}}},V={class:"min-h-screen bg-gray-50"},F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},O={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},A={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},B={class:"mt-4 flex justify-between items-center"},U=["disabled"],M={class:"bg-white rounded-lg shadow-sm border border-gray-200"},j={class:"px-6 py-4 border-b border-gray-200"},z={class:"flex justify-between items-center"},L={class:"text-lg font-medium text-gray-900 dark:text-white"},q={class:"flex items-center space-x-4"},H=["disabled"],J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Q={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},W={key:0},X={key:1},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm font-medium text-gray-900 dark:text-white"},$={class:"px-6 py-4 whitespace-nowrap"},tt={class:"text-sm font-medium text-gray-900 dark:text-white"},et={class:"text-sm text-gray-500 dark:text-gray-400"},rt={class:"text-xs text-gray-400 dark:text-gray-500"},st={key:0,class:"text-xs text-gray-600 dark:text-gray-400"},at={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900 dark:text-white"},it={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},dt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"text-sm text-gray-900 dark:text-white"},nt={class:"px-6 py-4 whitespace-nowrap"},gt={class:"text-sm text-gray-900 dark:text-white"},yt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},xt={class:"px-6 py-4 whitespace-nowrap"},pt={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},mt={key:1,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},ut={class:"px-6 py-4 whitespace-nowrap"},ft={class:"text-sm text-gray-900 dark:text-white"},ht={class:"text-sm text-gray-500 dark:text-gray-400"},bt={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700"},_t={class:"flex items-center justify-between"},kt={class:"text-sm text-gray-700 dark:text-gray-300"},wt={class:"flex space-x-2"},vt=["disabled"],Dt=["onClick"],Pt=["disabled"];function Nt(a,e,d,g,s,i){const m=f("ArrowDownTrayIcon"),x=f("ArrowUpIcon"),y=f("ArrowDownIcon");return l(),n("div",V,[t("div",F,[t("div",O,[e[14]||(e[14]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Search Dispatched Gifts",-1)),t("div",A,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Gift ID",-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.filters.giftId=r),type:"text",placeholder:"Enter Gift ID...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[h,s.filters.giftId]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Gift Name",-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.filters.giftName=r),type:"text",placeholder:"Enter Gift Name...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[h,s.filters.giftName]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Persona Details",-1)),p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.filters.personaDetails=r),type:"text",placeholder:"Name, Emirates ID, Phone...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[h,s.filters.personaDetails]])])]),t("div",B,[t("button",{onClick:e[3]||(e[3]=(...r)=>i.applyFilters&&i.applyFilters(...r)),disabled:s.loading,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"}," Search ",8,U),t("button",{onClick:e[4]||(e[4]=(...r)=>i.clearFilters&&i.clearFilters(...r)),class:"text-sm text-gray-500 hover:text-gray-700"}," Clear Search ")])]),t("div",M,[t("div",j,[t("div",z,[t("h3",L," Dispatched Gifts ("+o(s.totalRecords)+" total) ",1),t("div",q,[t("button",{onClick:e[5]||(e[5]=(...r)=>i.exportReport&&i.exportReport(...r)),disabled:s.isExporting||s.reportData.length===0,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"},[I(m,{class:"h-4 w-4 mr-2"}),R(" "+o(s.isExporting?"Exporting...":"Export"),1)],8,H),p(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>s.sortBy=r),onChange:e[7]||(e[7]=(...r)=>i.applyFilters&&i.applyFilters(...r)),class:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white"},[...e[15]||(e[15]=[t("option",{value:"creation"},"Sort by Created Date",-1),t("option",{value:"date"},"Sort by Dispatch Date",-1),t("option",{value:"gift_name"},"Sort by Gift Name",-1),t("option",{value:"owner_full_name"},"Sort by Owner Name",-1)])],544),[[S,s.sortBy]]),t("button",{onClick:e[8]||(e[8]=(...r)=>i.toggleSortOrder&&i.toggleSortOrder(...r)),class:"p-1 rounded text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"},[s.sortOrder==="asc"?(l(),b(x,{key:0,class:"h-4 w-4"})):(l(),b(y,{key:1,class:"h-4 w-4"}))])])])]),t("div",J,[t("table",K,[e[18]||(e[18]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Gift Code"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Gift"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Owner"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Coordinator"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Contact"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Dispatch Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Delivery Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Created By")])],-1)),t("tbody",Q,[s.loading?(l(),n("tr",W,[...e[16]||(e[16]=[t("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"},[t("div",{class:"flex justify-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"})]),t("div",{class:"mt-2"},"Loading...")],-1)])])):s.reportData.length===0?(l(),n("tr",X,[...e[17]||(e[17]=[t("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"}," No dispatched gifts found ",-1)])])):(l(!0),n(_,{key:2},k(s.reportData,r=>(l(),n("tr",{key:r.dispatch_id},[t("td",Y,[t("div",Z,o(r.gift_id||"N/A"),1)]),t("td",$,[t("div",null,[t("div",tt,o(r.gift_name),1),t("div",et,o(r.category),1),t("div",rt,o(r.barcode_value),1),r.gift_value?(l(),n("div",st," Value: "+o(r.gift_value),1)):c("",!0)])]),t("td",at,[t("div",null,[t("div",ot,o(r.owner_full_name),1),r.emirates_id?(l(),n("div",it,o(r.emirates_id),1)):c("",!0)])]),t("td",dt,[t("div",lt,o(r.coordinator_full_name),1)]),t("td",nt,[t("div",null,[t("div",gt,o(r.mobile_number),1),r.address?(l(),n("div",yt,o(r.address),1)):c("",!0)])]),t("td",ct,o(i.formatDate(r.dispatch_date)),1),t("td",xt,[t("div",null,[t("span",{class:w(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",r.delivery_status==="Delivered"?"bg-gray-200 text-gray-900 dark:bg-gray-700 dark:text-white":"bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-200"])},o(r.delivery_status||"Dispatched"),3),r.delivery_date?(l(),n("div",pt," Delivered: "+o(i.formatDate(r.delivery_date)),1)):c("",!0),r.delivery_note?(l(),n("div",mt,o(r.delivery_note),1)):c("",!0)])]),t("td",ut,[t("div",null,[t("div",ft,o(r.creator_name||"Unknown"),1),t("div",ht,o(i.formatDate(r.created_date)),1)])])]))),128))])])]),s.totalPages>1?(l(),n("div",bt,[t("div",_t,[t("div",kt," Showing "+o((s.currentPage-1)*s.pageSize+1)+" to "+o(Math.min(s.currentPage*s.pageSize,s.totalRecords))+" of "+o(s.totalRecords)+" entries ",1),t("div",wt,[t("button",{onClick:e[9]||(e[9]=r=>i.goToPage(s.currentPage-1)),disabled:s.currentPage===1,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Previous ",8,vt),(l(!0),n(_,null,k(i.visiblePages,r=>(l(),n("button",{key:r,onClick:Ct=>i.goToPage(r),class:w(["px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium",r===s.currentPage?"bg-gray-900 text-white border-gray-900":"text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},o(r),11,Dt))),128)),t("button",{onClick:e[10]||(e[10]=r=>i.goToPage(s.currentPage+1)),disabled:s.currentPage===s.totalPages,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Next ",8,Pt)])])])):c("",!0)])])])}const Gt=D(T,[["render",Nt]]);export{Gt as default};
//# sourceMappingURL=DispatchedGiftsReport-BmC418Dt.js.map
