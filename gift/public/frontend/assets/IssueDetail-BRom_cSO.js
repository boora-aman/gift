var I=(M,e,m)=>new Promise((o,P)=>{var S=p=>{try{F(m.next(p))}catch(_){P(_)}},G=p=>{try{F(m.throw(p))}catch(_){P(_)}},F=p=>p.done?o(p.value):Promise.resolve(p.value).then(S,G);F((m=m.apply(M,e)).next())});import{c as d,o as a,a as t,_ as Ce,Z as Ie,$ as Fe,q as Ee,A as Me,P as je,W as Ge,a0 as Ne,a1 as Ae,K as Ue,l as Ve,e as D,g as c,t as n,h as x,f as u,w as k,a2 as se,H as J,n as w,N as Le,j as Y,X as Pe,v as E,F as Se,k as Te,x as Oe,m as ze,u as Be,p as y,y as W,B as qe,D as We,z as He,L as H,G as Re,I as re}from"./index-DXfJHqnU.js";import{r as Xe}from"./TrashIcon-BtZczJiP.js";import{r as Je}from"./PhotoIcon-DBuEETk9.js";function Qe(M,e){return a(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})])}const Ze={name:"IssueDetail",components:{ArrowLeftIcon:Ve,GiftIcon:Ue,ClipboardDocumentIcon:Ae,CheckIcon:Ne,PencilIcon:Ge,PlusIcon:je,XMarkIcon:Me,ExclamationTriangleIcon:Ee,UserIcon:Fe,PhoneIcon:Qe,PhotoIcon:Je,TrashIcon:Xe,EllipsisVerticalIcon:Ie},setup(){const M=Oe(),e=ze(),{showNotification:m}=Be(),o=y(!0),P=y(null),S=y(!1),G=y(!1),F=y(!1),p=y(!1),_=y(!1),N=y(!1),V=y(!1),B=y(!1),R=y(!1),T=y(!1),O=y([]),L=y(""),A=y(!1),i=W({}),h=W({}),g=W({}),v=W({delivery_date:"",delivery_note:"",delivery_description:""}),j=W({}),X=()=>I(this,null,function*(){try{o.value=!0;const s=M.params.id,l=yield H.get(s);if(l.success)Object.keys(i).forEach(f=>delete i[f]),B.value=!1,Object.assign(i,l.data),r();else throw new Error(l.error||"Failed to load issue")}catch(s){console.error("Failed to load issue:",s),P.value=s.message||"Failed to load dispatch details. Please try again."}finally{o.value=!1}}),r=()=>{Object.assign(h,{owner_full_name:i.owner_full_name||"",owner_full_name:i.owner_full_name||"",coordinator_full_name:i.coordinator_full_name||"",coordinator_full_name:i.coordinator_full_name||"",emirates_id:i.emirates_id||"",mobile_number:i.mobile_number||"",person_photo:i.person_photo||"",date:i.date||""}),Object.keys(g).forEach(s=>delete g[s])},q=s=>{const l=s.replace(/[\s\-()]/g,"");return[/^\+971(50|51|52|53|54|55|56|58)\d{7}$/,/^00971(50|51|52|53|54|55|56|58)\d{7}$/,/^0(50|51|52|53|54|55|56|58)\d{7}$/,/^(50|51|52|53|54|55|56|58)\d{7}$/].some(b=>b.test(l))},le=s=>{const l=s.replace(/[\s\-]/g,"");return[/^\d{3}-\d{4}-\d{7}-\d{1}$/,/^\d{15}$/].some(b=>b.test(s))||/^\d{15}$/.test(l)},ie=()=>{Object.keys(g).forEach(l=>delete g[l]);let s=!0;return h.owner_full_name.trim()||(g.owner_full_name="Owner first name is required",s=!1),h.owner_full_name.trim()||(g.owner_full_name="Owner last name is required",s=!1),h.coordinator_full_name.trim()||(g.coordinator_full_name="Coordinator first name is required",s=!1),h.coordinator_full_name.trim()||(g.coordinator_full_name="Coordinator last name is required",s=!1),h.emirates_id.trim()?le(h.emirates_id)||(g.emirates_id="Please enter a valid Emirates ID (e.g., 784-1234-1234567-8)",s=!1):(g.emirates_id="Emirates ID is required",s=!1),h.mobile_number&&!q(h.mobile_number)&&(g.mobile_number="Please enter a valid UAE mobile number (e.g., +971501234567, 0501234567, 501234567)",s=!1),h.date||(g.date="Dispatch date is required",s=!1),s},ae=()=>I(this,null,function*(){if(ie())try{_.value=!0;const s=yield H.update(i.name,h);if(s.success)Object.assign(i,h),S.value=!1,m("Gift issue updated successfully","success");else throw new Error(s.error||"Failed to update issue")}catch(s){console.error("Failed to save changes:",s),m(s.message||"Failed to save changes","error")}finally{_.value=!1}}),ne=()=>{S.value=!1,r()},de=s=>I(this,null,function*(){const l=s.target.files[0];if(l){if(l.size>2*1024*1024){m("File size must be less than 2MB","error");return}if(!l.type.startsWith("image/")){m("Please select an image file","error");return}try{const f=yield re.upload(l,!0);if(f.success)h.person_photo=f.data.file_url,m("Photo uploaded successfully","success");else throw new Error(f.error||"Failed to upload photo")}catch(f){console.error("Failed to upload photo:",f),m(f.message||"Failed to upload photo","error")}}}),ce=s=>I(this,null,function*(){const l=s.target.files[0];if(!l)return;if(l.size>5*1024*1024){m("File size must be less than 5MB","error");return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","image/jpeg","image/jpg","image/png"].includes(l.type)){m("Please select a valid file type (PDF, DOC, DOCX, TXT, JPG, PNG)","error");return}try{const b=yield re.upload(l,!0);if(b.success)v.delivery_note=b.data.file_url,m("Delivery note uploaded successfully","success");else throw new Error(b.error||"Failed to upload delivery note")}catch(b){console.error("Failed to upload delivery note:",b),m(b.message||"Failed to upload delivery note","error")}}),me=s=>s?s.split("/").pop():"",fe=()=>{G.value=!0},ue=()=>I(this,null,function*(){try{N.value=!0;const s=yield H.delete(i.name);if(s.success)m("Gift issue deleted successfully","success"),e.push("/issues");else throw new Error(s.error||"Failed to delete dispatch")}catch(s){console.error("Failed to delete dispatch:",s),m(s.message||"Failed to delete dispatch","error")}finally{N.value=!1,G.value=!1}}),be=()=>I(this,null,function*(){if(Object.keys(j).forEach(s=>delete j[s]),!v.delivery_date){j.delivery_date="Delivery date is required";return}try{V.value=!0;const s=yield H.updateDeliveryStatus(i.name,"Delivered",v.delivery_note,v.delivery_description,v.delivery_date);if(s.success)i.status="Delivered",i.delivery_date=v.delivery_date,i.delivery_note=v.delivery_note,i.delivery_description=v.delivery_description,F.value=!1,Q(),m("Delivery status updated successfully","success");else throw new Error(s.error||"Failed to update delivery status")}catch(s){console.error("Failed to update delivery status:",s),m(s.message||"Failed to update delivery status","error")}finally{V.value=!1}}),xe=()=>{F.value=!1,Q()},Q=()=>{v.delivery_date=new Date().toISOString().split("T")[0],v.delivery_note="",v.delivery_description="",Object.keys(j).forEach(s=>delete j[s])},$=(s,l)=>I(this,null,function*(){try{yield navigator.clipboard.writeText(s),m(`${l} copied to clipboard`,"success")}catch(f){m(`Failed to copy ${l.toLowerCase()}`,"error")}}),he=()=>I(this,null,function*(){const s=Z(),l=ee(),f=`
Gift Dispatch Details:
Owner: ${s}
Coordinator: ${l}
Emirates ID: ${i.emirates_id}
Mobile: ${i.mobile_number||"N/A"}
Gift: ${i.gift}
Category: ${te(i.category)}
Dispatch Date: ${K(i.date)}
Dispatch ID: ${i.name}
      `.trim();yield $(f,"Dispatch details")}),ge=()=>{i.mobile_number&&window.open(`tel:${i.mobile_number}`)},ve=s=>{s.target.style.display="none";const l=s.target.parentElement;if(l){const f=l.querySelector("svg");f&&(f.style.display="block")}},ye=s=>s?s.startsWith("http://")||s.startsWith("https://")?s:s.startsWith("/private/")||s.startsWith("private/")?`/api/method/frappe.core.doctype.file.file.download_file?file_url=${s.startsWith("/")?s:`/${s}`}`:s.startsWith("/files/")||s.startsWith("files/")?s.startsWith("/")?s:`/${s}`:`/files/${s}`:"",Z=()=>{const s=i.owner_full_name||"",l=i.owner_full_name||"";return`${s} ${l}`.trim()||"N/A"},ee=()=>{const s=i.coordinator_full_name||"",l=i.coordinator_full_name||"";return`${s} ${l}`.trim()||"N/A"},te=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"General",K=s=>s?new Date(s).toLocaleDateString("en-AE",{year:"numeric",month:"short",day:"numeric"}):"",pe=s=>s?new Date(s).toLocaleString("en-AE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",we=s=>{if(!s)return"";const l=new Date,f=new Date(s),b=l-f,C=Math.floor(b/(1e3*60)),U=Math.floor(b/(1e3*60*60)),z=Math.floor(b/(1e3*60*60*24));return C<1?"Just now":C<60?`${C} minute${C===1?"":"s"} ago`:U<24?`${U} hour${U===1?"":"s"} ago`:z<7?`${z} day${z===1?"":"s"} ago`:K(s)},oe=()=>I(this,null,function*(){try{T.value=!0;const s=yield Re.list({status:"Available"},1,100);if(s.success)O.value=s.data||[];else throw new Error(s.error||"Failed to load available gifts")}catch(s){console.error("Failed to load available gifts:",s),m(s.message||"Failed to load available gifts","error")}finally{T.value=!1}}),_e=qe(()=>{if(!L.value)return O.value;const s=L.value.toLowerCase();return O.value.filter(l=>{var f,b,C,U;return((f=l.gift_name)==null?void 0:f.toLowerCase().includes(s))||((b=l.gift_id)==null?void 0:b.toLowerCase().includes(s))||((C=l.barcode_value)==null?void 0:C.toLowerCase().includes(s))||((U=l.category)==null?void 0:U.toLowerCase().includes(s))})}),De=s=>I(this,null,function*(){try{const l=Z();if(!confirm(`Are you sure you want to dispatch "${s.gift_name}" to ${l}?

This will create a new dispatch entry with the same recipient details.`))return;A.value=!0;const b={gift:s.name,owner_full_name:i.owner_full_name,owner_full_name:i.owner_full_name,coordinator_full_name:i.coordinator_full_name,coordinator_full_name:i.coordinator_full_name,emirates_id:i.emirates_id,mobile_number:i.mobile_number,address:i.address,person_photo:i.person_photo,date:new Date().toISOString().split("T")[0]},C=yield H.create(b);if(C.success){const U=`âœ… Gift "${s.gift_name}" has been successfully dispatched to ${l}. Redirecting to new dispatch details...`;m(U,"success"),p.value=!1,setTimeout(()=>{const z=C.data.name;z&&e.push(`/issues/${z}`)},2e3)}else throw new Error(C.error||"Failed to dispatch gift")}catch(l){console.error("Failed to dispatch gift:",l),m(l.message||"Failed to dispatch gift","error")}finally{A.value=!1}}),ke=()=>{p.value=!1,L.value=""};return We(p,s=>{s&&oe()}),He(()=>{X(),Q(),document.addEventListener("click",s=>{(!s.target.closest(".relative")||s.target.closest(".fixed"))&&(R.value=!1)})}),{loading:o,error:P,issue:i,imageLoaded:B,showEditForm:S,showDeleteConfirm:G,showDeliveryModal:F,showDispatchMoreModal:p,saving:_,deleting:N,updatingDelivery:V,showActionsDropdown:R,loadingAvailableGifts:T,availableGifts:O,giftSearchQuery:L,filteredAvailableGifts:_e,dispatchingMoreGift:A,editForm:h,errors:g,deliveryForm:v,deliveryErrors:j,saveChanges:ae,cancelEdit:ne,handlePhotoChange:de,handleDeliveryNoteChange:ce,getFileName:me,deleteIssue:fe,confirmDelete:ue,updateDeliveryStatus:be,cancelDeliveryUpdate:xe,copyToClipboard:$,copyIssueDetails:he,callRecipient:ge,getFullImageUrl:ye,handleImageError:ve,getOwnerFullName:Z,getCoordinatorFullName:ee,formatCategory:te,formatDate:K,formatDateTime:pe,formatTimeAgo:we,loadAvailableGifts:oe,selectGiftForDispatch:De,cancelDispatchMore:ke}}},Ke={class:"min-h-full bg-desert-sand-50"},Ye={key:0,class:"flex items-center justify-center min-h-screen"},$e={key:1,class:"flex items-center justify-center min-h-screen"},et={class:"text-center"},tt={class:"text-charcoal-600 mb-4"},ot={key:2},st={class:"lg:hidden bg-white border-b border-charcoal-200 px-4 py-4 sticky top-0 z-30"},rt={class:"flex items-center justify-between"},lt={class:"flex items-center space-x-3"},it={class:"relative"},at={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},nt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},dt={class:"col-span-1 lg:col-span-2 space-y-8"},ct={class:"bg-white rounded-xl shadow-card p-6"},mt={class:"flex items-center justify-between mb-6"},ft={class:"space-y-6"},ut={class:"flex items-start space-x-6"},bt={class:"flex-shrink-0"},xt={class:"w-20 h-20 rounded-xl overflow-hidden bg-gray-100 flex items-center justify-center relative"},ht=["src","alt"],gt={class:"flex-1"},vt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},yt={class:"md:col-span-2 space-y-3"},pt={class:"space-y-4"},wt={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},_t={class:"border-t border-charcoal-100 pt-6"},Dt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},kt={class:"text-charcoal-900 font-medium"},Ct={class:"text-charcoal-900 font-mono text-sm"},It={class:"bg-white rounded-xl shadow-card p-6"},Ft={class:"flex items-center justify-between mb-6"},Et={class:"flex items-start space-x-6 mb-6"},Mt={class:"flex-shrink-0"},jt={class:"w-20 h-20 rounded-xl overflow-hidden bg-gray-100 flex items-center justify-center"},Gt=["src","alt"],Nt={class:"flex-1"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ut={class:"text-charcoal-900 font-medium"},Vt={class:"text-charcoal-900 font-medium"},Lt={class:"flex items-center space-x-2"},Pt={class:"text-charcoal-900 font-mono"},St={key:0},Tt={class:"flex items-center space-x-2"},Ot={class:"text-charcoal-900"},zt={class:"bg-white rounded-xl shadow-card p-6"},Bt={class:"flex items-center justify-between mb-6"},qt={key:0,class:"space-y-4"},Wt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ht={class:"text-charcoal-900 font-medium"},Rt={key:0,class:"space-y-2"},Xt={class:"flex items-center space-x-3 bg-gray-50 p-3 rounded-lg"},Jt={class:"text-charcoal-900 flex-1"},Qt=["href"],Zt={key:1,class:"space-y-2"},Kt={class:"text-charcoal-900 whitespace-pre-wrap bg-gray-50 p-3 rounded-lg"},Yt={key:1,class:"text-center py-8"},$t={class:"hidden lg:block lg:col-span-1 space-y-6"},eo={class:"bg-white rounded-xl shadow-card p-6"},to={class:"space-y-3"},oo={class:"bg-white rounded-xl shadow-card p-6"},so={class:"space-y-4 text-sm"},ro={class:"flex justify-between"},lo={class:"text-charcoal-900 font-mono"},io={class:"flex justify-between"},ao={class:"text-charcoal-900"},no={class:"flex justify-between"},co={class:"text-charcoal-900"},mo={class:"flex justify-between"},fo={class:"text-charcoal-900"},uo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},bo={class:"bg-white rounded-xl shadow-elevated max-w-2xl w-full max-h-[90vh] overflow-y-auto"},xo={class:"p-6"},ho={class:"flex items-center justify-between mb-6"},go={class:"space-y-4"},vo={class:"space-y-4"},yo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},po={key:0,class:"text-red-600 text-sm mt-1"},wo={key:0,class:"text-red-600 text-sm mt-1"},_o={class:"space-y-4"},Do={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ko={key:0,class:"text-red-600 text-sm mt-1"},Co={key:0,class:"text-red-600 text-sm mt-1"},Io={class:"space-y-4"},Fo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Eo={key:0,class:"text-red-600 text-sm mt-1"},Mo={key:0,class:"text-red-600 text-sm mt-1"},jo={class:"flex items-center space-x-4"},Go={class:"w-16 h-16 rounded-lg overflow-hidden bg-charcoal-100 flex items-center justify-center"},No=["src"],Ao={class:"flex-1"},Uo={class:"space-y-4"},Vo={key:0,class:"text-red-600 text-sm mt-1"},Lo={class:"flex items-center justify-end space-x-3 pt-6 border-t border-charcoal-200"},Po=["disabled"],So={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},To={class:"bg-white rounded-xl shadow-elevated max-w-md w-full p-6"},Oo={class:"flex items-center mb-4"},zo={class:"flex items-center justify-end space-x-3"},Bo=["disabled"],qo={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Wo={class:"bg-white rounded-xl shadow-elevated max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ho={class:"p-6"},Ro={class:"flex items-center justify-between mb-6"},Xo={key:0,class:"text-red-600 text-sm mt-1"},Jo={class:"flex items-center space-x-4"},Qo={key:0,class:"flex items-center space-x-2 text-sm"},Zo={class:"text-charcoal-900"},Ko={class:"flex-1"},Yo={key:0,class:"text-red-600 text-sm mt-1"},$o={class:"flex items-center justify-end space-x-3 pt-6 border-t border-charcoal-200"},es=["disabled"],ts={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},os={class:"bg-white rounded-xl shadow-elevated max-w-4xl w-full max-h-[90vh] overflow-y-auto"},ss={class:"p-6"},rs={class:"flex items-center justify-between mb-6"},ls={class:"text-sm text-charcoal-600 mt-1"},is={class:"font-medium"},as={key:0,class:"text-charcoal-500"},ns={class:"mb-6"},ds={class:"relative"},cs={key:0,class:"text-center py-8"},ms={key:1,class:"text-center py-8"},fs={class:"text-charcoal-600"},us={key:2,class:"max-h-96 overflow-y-auto border border-charcoal-200 rounded-lg"},bs=["onClick"],xs={class:"flex items-center space-x-4"},hs={class:"w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center"},gs=["src","alt"],vs={class:"flex-1"},ys={class:"font-semibold text-charcoal-900"},ps={class:"text-sm text-charcoal-600"},ws={class:"flex items-center space-x-2 mt-1"},_s={class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Ds=["onClick","disabled"],ks={key:0},Cs={key:1,class:"flex items-center"},Is={class:"flex items-center justify-end space-x-3 pt-6 border-t border-charcoal-200"},Fs=["disabled"];function Es(M,e,m,o,P,S){var h,g,v,j,X;const G=D("ExclamationTriangleIcon"),F=D("ArrowLeftIcon"),p=D("EllipsisVerticalIcon"),_=D("GiftIcon"),N=D("PencilIcon"),V=D("ClipboardDocumentIcon"),B=D("TrashIcon"),R=D("router-link"),T=D("UserIcon"),O=D("PhoneIcon"),L=D("CheckIcon"),A=D("XMarkIcon"),i=D("PhotoIcon");return a(),d("div",Ke,[o.loading?(a(),d("div",Ye,[...e[49]||(e[49]=[t("div",{class:"animate-pulse text-center"},[t("div",{class:"w-16 h-16 bg-gray-100 rounded-xl mx-auto mb-4"}),t("div",{class:"h-4 bg-charcoal-200 rounded w-32 mx-auto mb-2"}),t("div",{class:"h-3 bg-charcoal-200 rounded w-24 mx-auto"})],-1)])])):o.error?(a(),d("div",$e,[t("div",et,[c(G,{class:"w-16 h-16 text-red-500 mx-auto mb-4"}),e[51]||(e[51]=t("h3",{class:"text-lg font-semibold text-charcoal-900 mb-2"},"Issue Not Found",-1)),t("p",tt,n(o.error),1),t("button",{onClick:e[0]||(e[0]=r=>M.$router.go(-1)),class:"inline-flex items-center px-4 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"},[c(F,{class:"w-4 h-4 mr-2"}),e[50]||(e[50]=x(" Go Back ",-1))])])])):(a(),d("div",ot,[t("div",st,[t("div",rt,[t("div",lt,[t("button",{onClick:e[1]||(e[1]=r=>M.$router.go(-1)),class:"p-2 text-charcoal-500 hover:text-charcoal-700 hover:bg-charcoal-100 rounded-lg transition-colors"},[c(F,{class:"w-5 h-5"})]),e[52]||(e[52]=t("h1",{class:"text-lg font-semibold text-charcoal-900 truncate"}," Gift Dispatch Details ",-1))]),t("div",it,[k(t("div",{class:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:e[2]||(e[2]=r=>o.showActionsDropdown=!1)},null,512),[[se,o.showActionsDropdown]]),t("button",{onClick:e[3]||(e[3]=r=>o.showActionsDropdown=!o.showActionsDropdown),class:"p-2 text-charcoal-500 hover:text-charcoal-700 hover:bg-charcoal-100 rounded-lg transition-colors relative z-50"},[c(p,{class:"w-5 h-5"})]),k(t("div",{class:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-charcoal-200 py-1 z-50",onClick:e[8]||(e[8]=J(()=>{},["stop"]))},[t("button",{onClick:e[4]||(e[4]=r=>{o.showDispatchMoreModal=!0,o.showActionsDropdown=!1}),class:"w-full flex items-center px-4 py-3 text-sm text-green-700 hover:bg-green-50 transition-colors"},[c(_,{class:"w-4 h-4 mr-3"}),e[53]||(e[53]=x(" Dispatch More Gift ",-1))]),e[57]||(e[57]=t("div",{class:"border-t border-charcoal-100 my-1"},null,-1)),t("button",{onClick:e[5]||(e[5]=r=>{o.showEditForm=!0,o.showActionsDropdown=!1}),class:"w-full flex items-center px-4 py-3 text-sm text-charcoal-700 hover:bg-charcoal-50 transition-colors"},[c(N,{class:"w-4 h-4 mr-3"}),e[54]||(e[54]=x(" Edit Dispatch ",-1))]),t("button",{onClick:e[6]||(e[6]=r=>{o.copyIssueDetails(),o.showActionsDropdown=!1}),class:"w-full flex items-center px-4 py-3 text-sm text-charcoal-700 hover:bg-charcoal-50 transition-colors"},[c(V,{class:"w-4 h-4 mr-3"}),e[55]||(e[55]=x(" Copy Details ",-1))]),e[58]||(e[58]=t("div",{class:"border-t border-charcoal-100 my-1"},null,-1)),t("button",{onClick:e[7]||(e[7]=r=>{o.deleteIssue(),o.showActionsDropdown=!1}),class:"w-full flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors"},[c(B,{class:"w-4 h-4 mr-3"}),e[56]||(e[56]=x(" Delete Dispatch ",-1))])],512),[[se,o.showActionsDropdown]])])])]),t("div",at,[t("div",nt,[t("div",dt,[t("div",ct,[t("div",mt,[e[60]||(e[60]=t("h2",{class:"text-xl font-semibold text-charcoal-900"},"Gift Dispatch Information",-1)),t("button",{onClick:e[9]||(e[9]=r=>o.showEditForm=!0),class:"hidden lg:inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors"},[c(N,{class:"w-4 h-4 mr-1.5"}),e[59]||(e[59]=x(" Edit ",-1))])]),t("div",ft,[t("div",ut,[t("div",bt,[t("div",xt,[(h=o.issue.gift_details)!=null&&h.first_image?(a(),d("img",{key:0,src:o.issue.gift_details.first_image,alt:((g=o.issue.gift_details)==null?void 0:g.gift_name)||"Gift image",class:w(["w-full h-full object-cover absolute inset-0",{"opacity-100":o.imageLoaded,"opacity-0":!o.imageLoaded}]),onLoad:e[10]||(e[10]=r=>o.imageLoaded=!0),onError:e[11]||(e[11]=r=>o.imageLoaded=!1)},null,42,ht)):u("",!0),c(_,{class:w(["w-10 h-10 text-gray-700",{"opacity-100":!o.imageLoaded||!((v=o.issue.gift_details)!=null&&v.first_image),"opacity-0":o.imageLoaded&&((j=o.issue.gift_details)==null?void 0:j.first_image)}])},null,8,["class"])])]),t("div",gt,[t("div",vt,[t("div",yt,[t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Gift Name ",-1)),c(R,{to:`/gifts/${o.issue.gift}`,class:"text-gray-700 hover:text-gray-800 font-semibold text-lg"},{default:Le(()=>{var r;return[x(n(((r=o.issue.gift_details)==null?void 0:r.gift_name)||o.issue.gift_name||o.issue.gift),1)]}),_:1},8,["to"])])]),t("div",pt,[t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Category ",-1)),t("span",wt,n(o.formatCategory(((X=o.issue.gift_details)==null?void 0:X.category)||o.issue.category)),1)])])])])]),t("div",_t,[t("div",Dt,[t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Dispatch Date ",-1)),t("p",kt,n(o.formatDate(o.issue.date)),1)]),t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Dispatch ID ",-1)),t("p",Ct,n(o.issue.name),1)]),t("div",null,[e[65]||(e[65]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Status ",-1)),t("span",{class:w(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-blue-100 text-blue-800":o.issue.status==="Dispatched","bg-green-100 text-green-800":o.issue.status==="Delivered"}])},n(o.issue.status||"Dispatched"),3)])])])])]),t("div",It,[t("div",Ft,[e[67]||(e[67]=t("h2",{class:"text-xl font-semibold text-charcoal-900"},"Recipient Information",-1)),t("button",{onClick:e[12]||(e[12]=r=>o.showEditForm=!0),class:"hidden lg:inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors"},[c(N,{class:"w-4 h-4 mr-1.5"}),e[66]||(e[66]=x(" Edit ",-1))])]),t("div",Et,[t("div",Mt,[t("div",jt,[o.issue.person_photo?(a(),d("img",{key:0,src:o.getFullImageUrl(o.issue.person_photo),alt:`${o.getOwnerFullName()} photo`,class:"w-full h-full object-cover",onError:e[13]||(e[13]=(...r)=>o.handleImageError&&o.handleImageError(...r))},null,40,Gt)):(a(),Y(T,{key:1,class:"w-10 h-10 text-gray-700"}))])]),t("div",Nt,[t("div",At,[t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Owner Name ",-1)),t("p",Ut,n(o.getOwnerFullName()),1)]),t("div",null,[e[69]||(e[69]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Coordinator Name ",-1)),t("p",Vt,n(o.getCoordinatorFullName()),1)]),t("div",null,[e[70]||(e[70]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Coordinator Emirates ID ",-1)),t("div",Lt,[t("p",Pt,n(o.issue.emirates_id),1),t("button",{onClick:e[14]||(e[14]=r=>o.copyToClipboard(o.issue.emirates_id,"Emirates ID")),class:"p-1 text-charcoal-500 hover:text-gray-700 transition-colors",title:"Copy Emirates ID"},[c(V,{class:"w-4 h-4"})])])]),o.issue.mobile_number?(a(),d("div",St,[e[71]||(e[71]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Coordinator Mobile Number ",-1)),t("div",Tt,[t("p",Ot,n(o.issue.mobile_number),1),t("button",{onClick:e[15]||(e[15]=(...r)=>o.callRecipient&&o.callRecipient(...r)),class:"p-1 text-charcoal-500 hover:text-gray-700 transition-colors",title:"Call recipient"},[c(O,{class:"w-4 h-4"})])])])):u("",!0)])])])]),t("div",zt,[t("div",Bt,[e[73]||(e[73]=t("h2",{class:"text-xl font-semibold text-charcoal-900"},"Delivery Information",-1)),o.issue.status==="Dispatched"?(a(),d("button",{key:0,onClick:e[16]||(e[16]=r=>o.showDeliveryModal=!0),class:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-white bg-green-600 border border-green-600 rounded-lg hover:bg-green-700 transition-colors"},[c(L,{class:"w-4 h-4 mr-1.5"}),e[72]||(e[72]=x(" Update Delivery Info ",-1))])):u("",!0)]),o.issue.status==="Delivered"?(a(),d("div",qt,[t("div",Wt,[t("div",null,[e[74]||(e[74]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Delivery Date ",-1)),t("p",Ht,n(o.formatDate(o.issue.delivery_date)),1)]),e[75]||(e[75]=t("div",null,[t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Delivery Status "),t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"}," Delivered ")],-1))]),o.issue.delivery_note?(a(),d("div",Rt,[e[78]||(e[78]=t("label",{class:"block text-sm font-medium text-charcoal-700"}," Delivery Note ",-1)),t("div",Xt,[e[77]||(e[77]=t("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("span",Jt,n(o.getFileName(o.issue.delivery_note)),1),t("a",{href:o.getFullImageUrl(o.issue.delivery_note),target:"_blank",class:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 rounded-full hover:bg-blue-100 transition-colors",title:"Download file"},[...e[76]||(e[76]=[t("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),x(" Download ",-1)])],8,Qt)])])):u("",!0),o.issue.delivery_description?(a(),d("div",Zt,[e[79]||(e[79]=t("label",{class:"block text-sm font-medium text-charcoal-700"}," Delivery Description ",-1)),t("p",Kt,n(o.issue.delivery_description),1)])):u("",!0)])):(a(),d("div",Yt,[e[81]||(e[81]=Pe('<div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center" data-v-67d099d5><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-67d099d5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-4v4H7V9a4 4 0 018 0z" data-v-67d099d5></path></svg></div><h3 class="text-lg font-medium text-charcoal-900 mb-2" data-v-67d099d5>Awaiting Delivery</h3><p class="text-charcoal-600 mb-4" data-v-67d099d5>This gift has been dispatched but not yet delivered.</p>',3)),t("button",{onClick:e[17]||(e[17]=r=>o.showDeliveryModal=!0),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 transition-colors"},[c(L,{class:"w-4 h-4 mr-2"}),e[80]||(e[80]=x(" Mark as Delivered ",-1))])]))])]),t("div",$t,[t("div",eo,[e[86]||(e[86]=t("h3",{class:"text-lg font-semibold text-charcoal-900 mb-4"},"Actions",-1)),t("div",to,[t("button",{onClick:e[18]||(e[18]=r=>o.showDispatchMoreModal=!0),class:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 transition-colors"},[c(_,{class:"w-4 h-4 mr-2"}),e[82]||(e[82]=x(" Dispatch More Gift ",-1))]),t("button",{onClick:e[19]||(e[19]=r=>o.showEditForm=!0),class:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gray-600 hover:bg-gray-700 transition-colors"},[c(N,{class:"w-4 h-4 mr-2"}),e[83]||(e[83]=x(" Edit Dispatch ",-1))]),t("button",{onClick:e[20]||(e[20]=(...r)=>o.copyIssueDetails&&o.copyIssueDetails(...r)),class:"w-full inline-flex items-center justify-center px-4 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"},[c(V,{class:"w-4 h-4 mr-2"}),e[84]||(e[84]=x(" Copy Details ",-1))]),t("button",{onClick:e[21]||(e[21]=(...r)=>o.deleteIssue&&o.deleteIssue(...r)),class:"w-full inline-flex items-center justify-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-600 bg-red-50 hover:bg-red-100 transition-colors"},[c(B,{class:"w-4 h-4 mr-2"}),e[85]||(e[85]=x(" Delete Dispatch ",-1))])])]),t("div",oo,[e[91]||(e[91]=t("h3",{class:"text-lg font-semibold text-charcoal-900 mb-4"},"Details",-1)),t("div",so,[t("div",ro,[e[87]||(e[87]=t("span",{class:"text-charcoal-600"},"Dispatch ID",-1)),t("span",lo,n(o.issue.name),1)]),t("div",io,[e[88]||(e[88]=t("span",{class:"text-charcoal-600"},"Created",-1)),t("span",ao,n(o.formatDate(o.issue.creation)),1)]),t("div",no,[e[89]||(e[89]=t("span",{class:"text-charcoal-600"},"Modified",-1)),t("span",co,n(o.formatDate(o.issue.modified)),1)]),t("div",mo,[e[90]||(e[90]=t("span",{class:"text-charcoal-600"},"Issued by",-1)),t("span",fo,n(o.issue.owner||"System"),1)])])])])])]),o.showEditForm?(a(),d("div",uo,[t("div",bo,[t("div",xo,[t("div",ho,[e[92]||(e[92]=t("h3",{class:"text-xl font-semibold text-charcoal-900"},"Edit Gift Issue",-1)),t("button",{onClick:e[22]||(e[22]=(...r)=>o.cancelEdit&&o.cancelEdit(...r)),class:"p-2 text-charcoal-500 hover:text-charcoal-700 transition-colors"},[c(A,{class:"w-5 h-5"})])]),t("form",{onSubmit:e[34]||(e[34]=J((...r)=>o.saveChanges&&o.saveChanges(...r),["prevent"])),class:"space-y-6"},[t("div",go,[e[104]||(e[104]=t("h4",{class:"text-lg font-medium text-charcoal-900"},"Personal Information",-1)),t("div",vo,[e[95]||(e[95]=t("h5",{class:"text-md font-medium text-charcoal-800"},"Owner Details",-1)),t("div",yo,[t("div",null,[e[93]||(e[93]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Owner First Name * ",-1)),k(t("input",{"onUpdate:modelValue":e[23]||(e[23]=r=>o.editForm.owner_full_name=r),type:"text",required:"",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.owner_full_name}])},null,2),[[E,o.editForm.owner_full_name]]),o.errors.owner_full_name?(a(),d("p",po,n(o.errors.owner_full_name),1)):u("",!0)]),t("div",null,[e[94]||(e[94]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Owner Last Name * ",-1)),k(t("input",{"onUpdate:modelValue":e[24]||(e[24]=r=>o.editForm.owner_full_name=r),type:"text",required:"",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.owner_full_name}])},null,2),[[E,o.editForm.owner_full_name]]),o.errors.owner_full_name?(a(),d("p",wo,n(o.errors.owner_full_name),1)):u("",!0)])])]),t("div",_o,[e[98]||(e[98]=t("h5",{class:"text-md font-medium text-charcoal-800"},"Coordinator Details",-1)),t("div",Do,[t("div",null,[e[96]||(e[96]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Coordinator First Name * ",-1)),k(t("input",{"onUpdate:modelValue":e[25]||(e[25]=r=>o.editForm.coordinator_full_name=r),type:"text",required:"",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.coordinator_full_name}])},null,2),[[E,o.editForm.coordinator_full_name]]),o.errors.coordinator_full_name?(a(),d("p",ko,n(o.errors.coordinator_full_name),1)):u("",!0)]),t("div",null,[e[97]||(e[97]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Coordinator Last Name * ",-1)),k(t("input",{"onUpdate:modelValue":e[26]||(e[26]=r=>o.editForm.coordinator_full_name=r),type:"text",required:"",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.coordinator_full_name}])},null,2),[[E,o.editForm.coordinator_full_name]]),o.errors.coordinator_full_name?(a(),d("p",Co,n(o.errors.coordinator_full_name),1)):u("",!0)])])]),t("div",Io,[e[101]||(e[101]=t("h5",{class:"text-md font-medium text-charcoal-800"},"Contact Details",-1)),t("div",Fo,[t("div",null,[e[99]||(e[99]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Emirates ID * ",-1)),k(t("input",{"onUpdate:modelValue":e[27]||(e[27]=r=>o.editForm.emirates_id=r),type:"text",required:"",placeholder:"xxx-xxxx-xxxxxxx-x",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.emirates_id}])},null,2),[[E,o.editForm.emirates_id]]),o.errors.emirates_id?(a(),d("p",Eo,n(o.errors.emirates_id),1)):u("",!0)]),t("div",null,[e[100]||(e[100]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Mobile Number ",-1)),k(t("input",{"onUpdate:modelValue":e[28]||(e[28]=r=>o.editForm.mobile_number=r),type:"tel",placeholder:"+971 50 123 4567",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.mobile_number}])},null,2),[[E,o.editForm.mobile_number]]),o.errors.mobile_number?(a(),d("p",Mo,n(o.errors.mobile_number),1)):u("",!0)])])]),t("div",null,[e[103]||(e[103]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Person Photo ",-1)),t("div",jo,[t("div",Go,[o.editForm.person_photo?(a(),d("img",{key:0,src:o.getFullImageUrl(o.editForm.person_photo),alt:"Preview photo",class:"w-full h-full object-cover",onError:e[29]||(e[29]=(...r)=>o.handleImageError&&o.handleImageError(...r))},null,40,No)):(a(),Y(T,{key:1,class:"w-8 h-8 text-charcoal-400"}))]),t("div",Ao,[t("input",{ref:"photoInput",type:"file",accept:"image/*",onChange:e[30]||(e[30]=(...r)=>o.handlePhotoChange&&o.handlePhotoChange(...r)),class:"hidden"},null,544),t("button",{type:"button",onClick:e[31]||(e[31]=r=>M.$refs.photoInput.click()),class:"inline-flex items-center px-3 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"},[c(i,{class:"w-4 h-4 mr-2"}),x(" "+n(o.editForm.person_photo?"Change Photo":"Upload Photo"),1)]),e[102]||(e[102]=t("p",{class:"text-xs text-charcoal-500 mt-1"}," JPG, PNG or WebP. Max file size 2MB. ",-1))])])])]),t("div",Uo,[e[106]||(e[106]=t("h4",{class:"text-lg font-medium text-charcoal-900"},"Dispatch Information",-1)),t("div",null,[e[105]||(e[105]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Dispatch Date ",-1)),k(t("input",{"onUpdate:modelValue":e[32]||(e[32]=r=>o.editForm.date=r),type:"date",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all",{"border-red-500":o.errors.date}])},null,2),[[E,o.editForm.date]]),o.errors.date?(a(),d("p",Vo,n(o.errors.date),1)):u("",!0)])]),t("div",Lo,[t("button",{type:"button",onClick:e[33]||(e[33]=(...r)=>o.cancelEdit&&o.cancelEdit(...r)),class:"px-4 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"}," Cancel "),t("button",{type:"submit",disabled:o.saving,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gray-600 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n(o.saving?"Saving...":"Save Changes"),9,Po)])],32)])])])):u("",!0),o.showDeleteConfirm?(a(),d("div",So,[t("div",To,[t("div",Oo,[c(G,{class:"w-8 h-8 text-red-500 mr-3"}),e[107]||(e[107]=t("h3",{class:"text-lg font-semibold text-charcoal-900"},"Confirm Deletion",-1))]),e[108]||(e[108]=t("p",{class:"text-charcoal-600 mb-6"}," Are you sure you want to delete this gift issue? This action cannot be undone. ",-1)),t("div",zo,[t("button",{onClick:e[35]||(e[35]=r=>o.showDeleteConfirm=!1),class:"px-4 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"}," Cancel "),t("button",{onClick:e[36]||(e[36]=(...r)=>o.confirmDelete&&o.confirmDelete(...r)),disabled:o.deleting,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n(o.deleting?"Deleting...":"Delete"),9,Bo)])])])):u("",!0),o.showDeliveryModal?(a(),d("div",qo,[t("div",Wo,[t("div",Ho,[t("div",Ro,[e[109]||(e[109]=t("h3",{class:"text-xl font-semibold text-charcoal-900"},"Update Delivery Information",-1)),t("button",{onClick:e[37]||(e[37]=(...r)=>o.cancelDeliveryUpdate&&o.cancelDeliveryUpdate(...r)),class:"p-2 text-charcoal-500 hover:text-charcoal-700 transition-colors"},[c(A,{class:"w-5 h-5"})])]),t("form",{onSubmit:e[44]||(e[44]=J((...r)=>o.updateDeliveryStatus&&o.updateDeliveryStatus(...r),["prevent"])),class:"space-y-6"},[t("div",null,[e[110]||(e[110]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Delivery Date * ",-1)),k(t("input",{"onUpdate:modelValue":e[38]||(e[38]=r=>o.deliveryForm.delivery_date=r),type:"date",required:"",class:w(["w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",{"border-red-500":o.deliveryErrors.delivery_date}])},null,2),[[E,o.deliveryForm.delivery_date]]),o.deliveryErrors.delivery_date?(a(),d("p",Xo,n(o.deliveryErrors.delivery_date),1)):u("",!0)]),t("div",null,[e[114]||(e[114]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Delivery Note (Attachment) ",-1)),t("div",Jo,[o.deliveryForm.delivery_note?(a(),d("div",Qo,[e[111]||(e[111]=t("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("span",Zo,n(o.getFileName(o.deliveryForm.delivery_note)),1),t("button",{type:"button",onClick:e[39]||(e[39]=r=>o.deliveryForm.delivery_note=""),class:"text-red-500 hover:text-red-700",title:"Remove file"},[c(A,{class:"w-4 h-4"})])])):u("",!0),t("div",Ko,[t("input",{ref:"deliveryNoteInput",type:"file",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png",onChange:e[40]||(e[40]=(...r)=>o.handleDeliveryNoteChange&&o.handleDeliveryNoteChange(...r)),class:"hidden"},null,544),t("button",{type:"button",onClick:e[41]||(e[41]=r=>M.$refs.deliveryNoteInput.click()),class:"inline-flex items-center px-3 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"},[e[112]||(e[112]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)),x(" "+n(o.deliveryForm.delivery_note?"Change File":"Upload File"),1)]),e[113]||(e[113]=t("p",{class:"text-xs text-charcoal-500 mt-1"}," PDF, DOC, DOCX, TXT, JPG, PNG. Max file size 5MB. ",-1))])]),o.deliveryErrors.delivery_note?(a(),d("p",Yo,n(o.deliveryErrors.delivery_note),1)):u("",!0)]),t("div",null,[e[115]||(e[115]=t("label",{class:"block text-sm font-medium text-charcoal-700 mb-1"}," Delivery Description ",-1)),k(t("textarea",{"onUpdate:modelValue":e[42]||(e[42]=r=>o.deliveryForm.delivery_description=r),rows:"4",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"Describe how the delivery was completed (optional)"},null,512),[[E,o.deliveryForm.delivery_description]])]),t("div",$o,[t("button",{type:"button",onClick:e[43]||(e[43]=(...r)=>o.cancelDeliveryUpdate&&o.cancelDeliveryUpdate(...r)),class:"px-4 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"}," Cancel "),t("button",{type:"submit",disabled:o.updatingDelivery,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n(o.updatingDelivery?"Updating...":"Mark as Delivered"),9,es)])],32)])])])):u("",!0),o.showDispatchMoreModal?(a(),d("div",ts,[t("div",os,[t("div",ss,[t("div",rs,[t("div",null,[e[117]||(e[117]=t("h3",{class:"text-xl font-semibold text-charcoal-900"},"Dispatch More Gift",-1)),t("p",ls,[e[116]||(e[116]=x(" Dispatching to: ",-1)),t("span",is,n(o.getOwnerFullName()),1),o.issue.emirates_id?(a(),d("span",as," ("+n(o.issue.emirates_id)+")",1)):u("",!0)])]),t("button",{onClick:e[45]||(e[45]=(...r)=>o.cancelDispatchMore&&o.cancelDispatchMore(...r)),class:"p-2 text-charcoal-500 hover:text-charcoal-700 transition-colors"},[c(A,{class:"w-5 h-5"})])]),t("div",ns,[t("div",ds,[e[118]||(e[118]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-charcoal-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),k(t("input",{"onUpdate:modelValue":e[46]||(e[46]=r=>o.giftSearchQuery=r),type:"text",class:"w-full pl-10 pr-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Search by gift name, code, or category..."},null,512),[[E,o.giftSearchQuery]])])]),o.loadingAvailableGifts?(a(),d("div",cs,[...e[119]||(e[119]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto"},null,-1),t("p",{class:"text-charcoal-600 mt-2"},"Loading available gifts...",-1)])])):o.filteredAvailableGifts.length===0?(a(),d("div",ms,[c(_,{class:"w-16 h-16 text-charcoal-400 mx-auto mb-4"}),e[120]||(e[120]=t("h3",{class:"text-lg font-semibold text-charcoal-900 mb-2"},"No Available Gifts",-1)),t("p",fs,n(o.giftSearchQuery?"No gifts match your search criteria.":"There are no available gifts to dispatch at the moment."),1)])):(a(),d("div",us,[(a(!0),d(Se,null,Te(o.filteredAvailableGifts,r=>(a(),d("div",{key:r.name,onClick:q=>!o.dispatchingMoreGift&&o.selectGiftForDispatch(r),class:w(["p-4 border-b border-charcoal-200 last:border-b-0 transition-colors",{"hover:bg-green-50 cursor-pointer":!o.dispatchingMoreGift,"opacity-50 cursor-not-allowed":o.dispatchingMoreGift}])},[t("div",xs,[t("div",hs,[r.first_image?(a(),d("img",{key:0,src:r.first_image,alt:r.gift_name,class:"w-full h-full object-cover",onError:e[47]||(e[47]=q=>q.target.style.display="none")},null,40,gs)):(a(),Y(_,{key:1,class:"w-8 h-8 text-gray-700"}))]),t("div",vs,[t("h4",ys,n(r.gift_name),1),t("p",ps,n(r.gift_id||r.barcode_value),1),t("div",ws,[t("span",_s,n(o.formatCategory(r.category)),1),e[121]||(e[121]=t("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"}," Available ",-1))])]),t("div",null,[t("button",{onClick:J(q=>o.selectGiftForDispatch(r),["stop"]),disabled:o.dispatchingMoreGift,class:w(["inline-flex items-center px-3 py-1.5 text-sm font-medium border rounded-lg transition-colors",{"text-white bg-green-600 border-green-600 hover:bg-green-700":!o.dispatchingMoreGift,"text-gray-400 bg-gray-100 border-gray-300 cursor-not-allowed":o.dispatchingMoreGift}])},[o.dispatchingMoreGift?(a(),d("span",Cs,[...e[122]||(e[122]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-3 w-3 text-gray-400",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" Dispatching... ",-1)])])):(a(),d("span",ks,"Select"))],10,Ds)])])],10,bs))),128))])),t("div",Is,[t("button",{onClick:e[48]||(e[48]=(...r)=>o.cancelDispatchMore&&o.cancelDispatchMore(...r)),disabled:o.dispatchingMoreGift,class:w(["px-4 py-2 border text-sm font-medium rounded-lg transition-colors",{"border-charcoal-300 text-charcoal-700 bg-white hover:bg-charcoal-50":!o.dispatchingMoreGift,"border-gray-300 text-gray-400 bg-gray-100 cursor-not-allowed":o.dispatchingMoreGift}])}," Cancel ",10,Fs)])])])])):u("",!0)]))])}const As=Ce(Ze,[["render",Es],["__scopeId","data-v-67d099d5"]]);export{As as default};
//# sourceMappingURL=IssueDetail-BRom_cSO.js.map
