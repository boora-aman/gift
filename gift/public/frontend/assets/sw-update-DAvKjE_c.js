var S=(t,r,e)=>new Promise((o,u)=>{var d=s=>{try{v(e.next(s))}catch(n){u(n)}},l=s=>{try{v(e.throw(s))}catch(n){u(n)}},v=s=>s.done?o(s.value):Promise.resolve(s.value).then(d,l);v((e=e.apply(t,r)).next())});try{self["workbox:window:7.2.0"]&&_()}catch(t){}function k(t,r){return new Promise(function(e){var o=new MessageChannel;o.port1.onmessage=function(u){e(u.data)},t.postMessage(r,[o.port2])})}function O(t){var r=function(e,o){if(typeof e!="object"||!e)return e;var u=e[Symbol.toPrimitive];if(u!==void 0){var d=u.call(e,o);if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t,"string");return typeof r=="symbol"?r:r+""}function I(t,r){for(var e=0;e<r.length;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,O(o.key),o)}}function j(t,r){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,o){return e.__proto__=o,e},j(t,r)}function L(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,o=new Array(r);e<r;e++)o[e]=t[e];return o}function R(t,r){var e=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(u,d){if(u){if(typeof u=="string")return L(u,d);var l=Object.prototype.toString.call(u).slice(8,-1);return l==="Object"&&u.constructor&&(l=u.constructor.name),l==="Map"||l==="Set"?Array.from(u):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?L(u,d):void 0}}(t))||r){e&&(t=e);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}try{self["workbox:core:7.2.0"]&&_()}catch(t){}var E=function(){var t=this;this.promise=new Promise(function(r,e){t.resolve=r,t.reject=e})};function P(t,r){var e=location.href;return new URL(t,e).href===new URL(r,e).href}var w=function(t,r){this.type=t,Object.assign(this,r)};function h(t,r,e){return e?r?r(t):t:(t&&t.then||(t=Promise.resolve(t)),r?t.then(r):t)}function x(){}var T={type:"SKIP_WAITING"};function W(t,r){return t&&t.then?t.then(x):Promise.resolve()}var M=function(t){function r(v,s){var n,i;return s===void 0&&(s={}),(n=t.call(this)||this).nn={},n.tn=0,n.rn=new E,n.en=new E,n.on=new E,n.un=0,n.an=new Set,n.cn=function(){var c=n.fn,a=c.installing;n.tn>0||!P(a.scriptURL,n.sn.toString())||performance.now()>n.un+6e4?(n.vn=a,c.removeEventListener("updatefound",n.cn)):(n.hn=a,n.an.add(a),n.rn.resolve(a)),++n.tn,a.addEventListener("statechange",n.ln)},n.ln=function(c){var a=n.fn,f=c.target,p=f.state,y=f===n.vn,b={sw:f,isExternal:y,originalEvent:c};!y&&n.mn&&(b.isUpdate=!0),n.dispatchEvent(new w(p,b)),p==="installed"?n.wn=self.setTimeout(function(){p==="installed"&&a.waiting===f&&n.dispatchEvent(new w("waiting",b))},200):p==="activating"&&(clearTimeout(n.wn),y||n.en.resolve(f))},n.yn=function(c){var a=n.hn,f=a!==navigator.serviceWorker.controller;n.dispatchEvent(new w("controlling",{isExternal:f,originalEvent:c,sw:a,isUpdate:n.mn})),f||n.on.resolve(a)},n.gn=(i=function(c){var a=c.data,f=c.ports,p=c.source;return h(n.getSW(),function(){n.an.has(p)&&n.dispatchEvent(new w("message",{data:a,originalEvent:c,ports:f,sw:p}))})},function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];try{return Promise.resolve(i.apply(this,c))}catch(f){return Promise.reject(f)}}),n.sn=v,n.nn=s,navigator.serviceWorker.addEventListener("message",n.gn),n}var e,o;o=t,(e=r).prototype=Object.create(o.prototype),e.prototype.constructor=e,j(e,o);var u,d,l=r.prototype;return l.register=function(v){var s=(v===void 0?{}:v).immediate,n=s!==void 0&&s;try{var i=this;return h(function(c,a){var f=c();return f&&f.then?f.then(a):a(f)}(function(){if(!n&&document.readyState!=="complete")return W(new Promise(function(c){return window.addEventListener("load",c)}))},function(){return i.mn=!!navigator.serviceWorker.controller,i.dn=i.pn(),h(i.bn(),function(c){i.fn=c,i.dn&&(i.hn=i.dn,i.en.resolve(i.dn),i.on.resolve(i.dn),i.dn.addEventListener("statechange",i.ln,{once:!0}));var a=i.fn.waiting;return a&&P(a.scriptURL,i.sn.toString())&&(i.hn=a,Promise.resolve().then(function(){i.dispatchEvent(new w("waiting",{sw:a,wasWaitingBeforeRegister:!0}))}).then(function(){})),i.hn&&(i.rn.resolve(i.hn),i.an.add(i.hn)),i.fn.addEventListener("updatefound",i.cn),navigator.serviceWorker.addEventListener("controllerchange",i.yn),i.fn})}))}catch(c){return Promise.reject(c)}},l.update=function(){try{return this.fn?h(W(this.fn.update())):h()}catch(v){return Promise.reject(v)}},l.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},l.messageSW=function(v){try{return h(this.getSW(),function(s){return k(s,v)})}catch(s){return Promise.reject(s)}},l.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&k(this.fn.waiting,T)},l.pn=function(){var v=navigator.serviceWorker.controller;return v&&P(v.scriptURL,this.sn.toString())?v:void 0},l.bn=function(){try{var v=this;return h(function(s,n){try{var i=s()}catch(c){return n(c)}return i&&i.then?i.then(void 0,n):i}(function(){return h(navigator.serviceWorker.register(v.sn,v.nn),function(s){return v.un=performance.now(),s})},function(s){throw s}))}catch(s){return Promise.reject(s)}},u=r,(d=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&I(u.prototype,d),Object.defineProperty(u,"prototype",{writable:!1}),u}(function(){function t(){this.Pn=new Map}var r=t.prototype;return r.addEventListener=function(e,o){this.jn(e).add(o)},r.removeEventListener=function(e,o){this.jn(e).delete(o)},r.dispatchEvent=function(e){e.target=this;for(var o,u=R(this.jn(e.type));!(o=u()).done;)(0,o.value)(e)},r.jn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},t}());let g,m,A;const U=()=>{const t=new CustomEvent("sw-update-available",{detail:{wb:g,registration:m}});window.dispatchEvent(t)};"serviceWorker"in navigator&&(g=new M("/sw.js",{scope:"/"}),g.addEventListener("waiting",t=>{A=t,U()}),g.addEventListener("controlling",t=>{window.location.reload()}),g.register().then(t=>{m=t}).catch(t=>{}),navigator.serviceWorker.addEventListener("message",t=>{if(t.data&&t.data.type)switch(t.data.type){case"SKIP_WAITING":U();break}}));const B=()=>{A&&(g.addEventListener("controlling",()=>{window.location.reload()}),g.messageSkipWaiting())},G=()=>S(void 0,null,function*(){if(m)try{yield m.update()}catch(t){console.warn("Manual update check failed:",t)}}),K=()=>m,N=t=>{window.addEventListener("sw-update-available",t)},F=t=>{window.removeEventListener("sw-update-available",t)};export{G as checkForUpdates,K as getRegistration,F as offUpdateAvailable,N as onUpdateAvailable,B as skipWaiting};
//# sourceMappingURL=sw-update-DAvKjE_c.js.map
