{"version":3,"file":"exportUtils-rTjg8JsQ.js","sources":["../../../../frontend/src/utils/exportUtils.js"],"sourcesContent":["/**\n * Excel export utility functions\n */\n\n/**\n * Export data to Excel file\n * @param {Array} data - Array of objects to export\n * @param {Array} columns - Array of column definitions { key, title }\n * @param {string} fileName - File name without extension\n */\nexport function exportToExcel(data, columns, fileName = 'export') {\n  try {\n    // Create CSV content\n    const csvContent = createCSVContent(data, columns)\n    \n    // Create blob and download\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\n    const link = document.createElement('a')\n    \n    if (link.download !== undefined) {\n      const url = URL.createObjectURL(blob)\n      link.setAttribute('href', url)\n      link.setAttribute('download', `${fileName}_${formatDate(new Date())}.csv`)\n      link.style.visibility = 'hidden'\n      document.body.appendChild(link)\n      link.click()\n      document.body.removeChild(link)\n      URL.revokeObjectURL(url)\n    }\n  } catch (error) {\n    console.error('Export to Excel error:', error)\n    throw new Error('Failed to export data to Excel')\n  }\n}\n\n/**\n * Create CSV content from data and columns\n * @param {Array} data - Data to convert\n * @param {Array} columns - Column definitions\n * @returns {string} CSV content\n */\nfunction createCSVContent(data, columns) {\n  // Create header row\n  const headers = columns.map(col => escapeCsvValue(col.title)).join(',')\n  \n  // Create data rows\n  const rows = data.map(row => {\n    return columns.map(col => {\n      const value = row[col.key]\n      return escapeCsvValue(value)\n    }).join(',')\n  })\n  \n  return [headers, ...rows].join('\\n')\n}\n\n/**\n * Escape CSV value for proper formatting\n * @param {any} value - Value to escape\n * @returns {string} Escaped value\n */\nfunction escapeCsvValue(value) {\n  if (value === null || value === undefined) {\n    return ''\n  }\n  \n  const stringValue = String(value)\n  \n  // If value contains comma, newline, or quote, wrap in quotes and escape internal quotes\n  if (stringValue.includes(',') || stringValue.includes('\\n') || stringValue.includes('\"')) {\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`\n  }\n  \n  return stringValue\n}\n\n/**\n * Format date for file name\n * @param {Date} date - Date to format\n * @returns {string} Formatted date string\n */\nfunction formatDate(date) {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const hours = String(date.getHours()).padStart(2, '0')\n  const minutes = String(date.getMinutes()).padStart(2, '0')\n  \n  return `${year}${month}${day}_${hours}${minutes}`\n}\n\n/**\n * Export data to JSON file\n * @param {Array} data - Data to export\n * @param {string} fileName - File name without extension\n */\nexport function exportToJSON(data, fileName = 'export') {\n  try {\n    const jsonContent = JSON.stringify(data, null, 2)\n    const blob = new Blob([jsonContent], { type: 'application/json;charset=utf-8;' })\n    const link = document.createElement('a')\n    \n    if (link.download !== undefined) {\n      const url = URL.createObjectURL(blob)\n      link.setAttribute('href', url)\n      link.setAttribute('download', `${fileName}_${formatDate(new Date())}.json`)\n      link.style.visibility = 'hidden'\n      document.body.appendChild(link)\n      link.click()\n      document.body.removeChild(link)\n      URL.revokeObjectURL(url)\n    }\n  } catch (error) {\n    console.error('Export to JSON error:', error)\n    throw new Error('Failed to export data to JSON')\n  }\n}"],"names":["exportToExcel","data","columns","fileName","csvContent","createCSVContent","blob","link","url","formatDate","error","headers","col","escapeCsvValue","rows","row","value","stringValue","date","year","month","day","hours","minutes"],"mappings":"AAUO,SAASA,EAAcC,EAAMC,EAASC,EAAW,SAAU,CAChE,GAAI,CAEF,MAAMC,EAAaC,EAAiBJ,EAAMC,CAAO,EAG3CI,EAAO,IAAI,KAAK,CAACF,CAAU,EAAG,CAAE,KAAM,yBAAyB,CAAE,EACjEG,EAAO,SAAS,cAAc,GAAG,EAEvC,GAAIA,EAAK,WAAa,OAAW,CAC/B,MAAMC,EAAM,IAAI,gBAAgBF,CAAI,EACpCC,EAAK,aAAa,OAAQC,CAAG,EAC7BD,EAAK,aAAa,WAAY,GAAGJ,CAAQ,IAAIM,EAAW,IAAI,IAAM,CAAC,MAAM,EACzEF,EAAK,MAAM,WAAa,SACxB,SAAS,KAAK,YAAYA,CAAI,EAC9BA,EAAK,MAAK,EACV,SAAS,KAAK,YAAYA,CAAI,EAC9B,IAAI,gBAAgBC,CAAG,CACzB,CACF,OAASE,EAAO,CACd,cAAQ,MAAM,yBAA0BA,CAAK,EACvC,IAAI,MAAM,gCAAgC,CAClD,CACF,CAQA,SAASL,EAAiBJ,EAAMC,EAAS,CAEvC,MAAMS,EAAUT,EAAQ,IAAIU,GAAOC,EAAeD,EAAI,KAAK,CAAC,EAAE,KAAK,GAAG,EAGhEE,EAAOb,EAAK,IAAIc,GACbb,EAAQ,IAAIU,GAAO,CACxB,MAAMI,EAAQD,EAAIH,EAAI,GAAG,EACzB,OAAOC,EAAeG,CAAK,CAC7B,CAAC,EAAE,KAAK,GAAG,CACZ,EAED,MAAO,CAACL,EAAS,GAAGG,CAAI,EAAE,KAAK;AAAA,CAAI,CACrC,CAOA,SAASD,EAAeG,EAAO,CAC7B,GAAIA,GAAU,KACZ,MAAO,GAGT,MAAMC,EAAc,OAAOD,CAAK,EAGhC,OAAIC,EAAY,SAAS,GAAG,GAAKA,EAAY,SAAS;AAAA,CAAI,GAAKA,EAAY,SAAS,GAAG,EAC9E,IAAIA,EAAY,QAAQ,KAAM,IAAI,CAAC,IAGrCA,CACT,CAOA,SAASR,EAAWS,EAAM,CACxB,MAAMC,EAAOD,EAAK,YAAW,EACvBE,EAAQ,OAAOF,EAAK,SAAQ,EAAK,CAAC,EAAE,SAAS,EAAG,GAAG,EACnDG,EAAM,OAAOH,EAAK,QAAO,CAAE,EAAE,SAAS,EAAG,GAAG,EAC5CI,EAAQ,OAAOJ,EAAK,SAAQ,CAAE,EAAE,SAAS,EAAG,GAAG,EAC/CK,EAAU,OAAOL,EAAK,WAAU,CAAE,EAAE,SAAS,EAAG,GAAG,EAEzD,MAAO,GAAGC,CAAI,GAAGC,CAAK,GAAGC,CAAG,IAAIC,CAAK,GAAGC,CAAO,EACjD"}