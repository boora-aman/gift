var C=(_,t,d)=>new Promise((r,c)=>{var b=s=>{try{p(d.next(s))}catch(x){c(x)}},u=s=>{try{p(d.throw(s))}catch(x){c(x)}},p=s=>s.done?r(s.value):Promise.resolve(s.value).then(b,u);p((d=d.apply(_,t)).next())});import{_ as z,s as N,A as M,J as U,K as E,l as F,e as k,c as a,o as i,a as e,g as v,H as L,f as h,t as n,w as m,v as g,F as P,k as q,E as R,h as j,m as B,x as O,u as T,p as G,y as X,B as H,z as J,G as A,L as K}from"./index-DXfJHqnU.js";const Q={name:"IssueCreate",components:{ArrowLeftIcon:F,GiftIcon:E,MagnifyingGlassIcon:U,XMarkIcon:M,ArrowPathIcon:N},setup(){const _=B(),t=O(),{showNotification:d}=T(),r=G(!1),c=G({}),b=G(""),u=G([]),p=G(null),s=X({gift:"",recipient_name:"",recipient_email:"",recipient_phone:"",recipient_organization:"",delivery_address:"",issue_date:new Date().toISOString().split("T")[0],reference_id:"",notes:"",send_email:!0,email_message:""}),x=H(()=>{if(!b.value)return u.value;const l=b.value.toLowerCase();return u.value.filter(f=>f.gift_name.toLowerCase().includes(l)||f.barcode_value&&f.barcode_value.toLowerCase().includes(l)||f.category.toLowerCase().includes(l))}),I=()=>C(this,null,function*(){try{const l=yield A.list({status:"Available"},1,100);if(l.success)u.value=l.data;else{d(l.error||"Failed to load available gifts","error");return}const f=t.query.gift;if(f){let y=u.value.find(w=>w.name===f);if(!y){const w=yield A.get(f);w.success&&w.data.status==="Available"&&(y=w.data,u.value.unshift(y))}y?o(y):d("Selected gift is not available for dispatch","warning")}}catch(l){console.error("Failed to load gifts:",l),d("Failed to load available gifts","error")}}),o=l=>{p.value=l,s.gift=l.name,c.value.gift=""},S=()=>{p.value=null,s.gift=""},D=()=>(c.value={},s.gift||(c.value.gift="Please select a gift to dispatch"),s.recipient_name.trim()||(c.value.recipient_name="Recipient name is required"),s.recipient_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.recipient_email)||(c.value.recipient_email="Please enter a valid email address"):c.value.recipient_email="Recipient email is required",s.issue_date||(c.value.issue_date="Dispatch date is required"),Object.keys(c.value).length===0),V=()=>C(this,null,function*(){if(D())try{r.value=!0;const l={gift:s.gift,recipient_name:s.recipient_name,recipient_email:s.recipient_email,recipient_phone:s.recipient_phone||"",recipient_organization:s.recipient_organization||"",delivery_address:s.delivery_address||"",issue_date:s.issue_date,reference_id:s.reference_id||"",notes:s.notes||"",send_email:s.send_email,email_message:s.email_message||""},f=yield K.create(l);f.success?(d("Gift dispatched successfully","success"),_.push("/issues")):d(f.error||"Failed to dispatch gift","error")}catch(l){console.error("Failed to create issue:",l),d("Failed to dispatch gift. Please try again.","error")}finally{r.value=!1}});return J(()=>{I()}),{form:s,errors:c,loading:r,giftSearch:b,availableGifts:u,preselectedGift:p,filteredGifts:x,selectGift:o,clearGiftSelection:S,createIssue:V}}},W={class:"min-h-full bg-desert-sand-50"},Y={class:"bg-white shadow-card"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},$={class:"flex items-center justify-between"},ee={class:"flex items-center space-x-4"},te={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 safe-area-padding"},re={class:"bg-white rounded-xl shadow-card p-6"},oe={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},se={class:"flex items-center space-x-4"},ae={class:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},ie={class:"flex-1"},le={class:"font-medium text-charcoal-900"},ne={class:"text-sm text-charcoal-600"},ce={key:1},de={class:"space-y-4"},fe={class:"relative"},me={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ue={class:"max-h-64 overflow-y-auto border border-charcoal-200 rounded-lg"},pe={key:0,class:"p-4 text-center text-charcoal-600"},he={key:1},ge=["onClick"],xe={class:"flex items-center space-x-4"},_e={class:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center"},be={class:"flex-1"},ve={class:"font-medium text-charcoal-900"},ye={class:"flex items-center space-x-2 text-sm text-charcoal-600"},we={class:"capitalize"},ke={key:2,class:"mt-2 text-sm text-red-600"},Ge={class:"bg-white rounded-xl shadow-card p-6"},Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ce={key:0,class:"mt-1 text-sm text-red-600"},Se={key:0,class:"mt-1 text-sm text-red-600"},Ae={key:0,class:"mt-1 text-sm text-red-600"},De={key:0,class:"mt-1 text-sm text-red-600"},Ve={class:"mt-6"},ze={key:0,class:"mt-1 text-sm text-red-600"},Ne={class:"bg-white rounded-xl shadow-card p-6"},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ue={key:0,class:"mt-1 text-sm text-red-600"},Ee={key:0,class:"mt-1 text-sm text-red-600"},Fe={class:"mt-6"},Le={key:0,class:"mt-1 text-sm text-red-600"},Pe={class:"bg-white rounded-xl shadow-card p-6"},qe={class:"space-y-4"},Re={class:"flex items-center justify-between"},je={class:"relative inline-flex items-center cursor-pointer"},Be={key:0,class:"pl-4 border-l-2 border-gray-200"},Oe={class:"flex items-center justify-end space-x-4 pt-6"},Te=["disabled"],Xe={key:0,class:"flex items-center"},He={key:1};function Je(_,t,d,r,c,b){const u=k("ArrowLeftIcon"),p=k("GiftIcon"),s=k("XMarkIcon"),x=k("MagnifyingGlassIcon"),I=k("ArrowPathIcon");return i(),a("div",W,[e("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[e("button",{onClick:t[0]||(t[0]=o=>_.$router.push("/issues")),class:"p-2 rounded-lg text-charcoal-600 hover:bg-charcoal-100 transition-colors"},[v(u,{class:"w-5 h-5"})]),t[15]||(t[15]=e("div",null,[e("h1",{class:"text-2xl lg:text-3xl font-bold text-charcoal-900"}," Dispatch New Gift "),e("p",{class:"text-charcoal-600"},"Create a new gift dispatch for a recipient")],-1))])])])]),e("div",te,[e("form",{onSubmit:t[14]||(t[14]=L((...o)=>r.createIssue&&r.createIssue(...o),["prevent"])),class:"space-y-8"},[e("div",re,[t[18]||(t[18]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Gift Selection",-1)),r.preselectedGift?(i(),a("div",oe,[e("div",se,[e("div",ae,[v(p,{class:"w-6 h-6 text-gray-700"})]),e("div",ie,[e("h3",le,n(r.preselectedGift.gift_name),1),e("p",ne,n(r.preselectedGift.barcode_value||r.preselectedGift.name),1)]),e("button",{type:"button",onClick:t[1]||(t[1]=(...o)=>r.clearGiftSelection&&r.clearGiftSelection(...o)),class:"text-charcoal-500 hover:text-charcoal-700"},[v(s,{class:"w-5 h-5"})])])])):(i(),a("div",ce,[e("div",de,[e("div",null,[t[16]||(t[16]=e("label",{for:"gift_search",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Search Gifts ",-1)),e("div",fe,[e("div",me,[v(x,{class:"w-5 h-5 text-charcoal-400"})]),m(e("input",{id:"gift_search","onUpdate:modelValue":t[2]||(t[2]=o=>r.giftSearch=o),type:"text",class:"w-full pl-10 pr-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Search by name, code, or category..."},null,512),[[g,r.giftSearch]])])]),e("div",ue,[r.availableGifts.length===0?(i(),a("div",pe," No available gifts found ")):(i(),a("div",he,[(i(!0),a(P,null,q(r.filteredGifts,o=>(i(),a("div",{key:o.name,onClick:S=>r.selectGift(o),class:"p-4 border-b border-charcoal-200 last:border-b-0 hover:bg-desert-sand-50 cursor-pointer transition-colors"},[e("div",xe,[e("div",_e,[v(p,{class:"w-5 h-5 text-gray-700"})]),e("div",be,[e("h4",ve,n(o.gift_name),1),e("div",ye,[e("span",null,n(o.barcode_value||o.name),1),t[17]||(t[17]=e("span",null,"â€¢",-1)),e("span",we,n(o.category),1)])])])],8,ge))),128))]))])])])),r.errors.gift?(i(),a("p",ke,n(r.errors.gift),1)):h("",!0)]),e("div",Ge,[t[24]||(t[24]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Recipient Information",-1)),e("div",Ie,[e("div",null,[t[19]||(t[19]=e("label",{for:"recipient_name",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Full Name * ",-1)),m(e("input",{id:"recipient_name","onUpdate:modelValue":t[3]||(t[3]=o=>r.form.recipient_name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter recipient's full name"},null,512),[[g,r.form.recipient_name]]),r.errors.recipient_name?(i(),a("p",Ce,n(r.errors.recipient_name),1)):h("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{for:"recipient_email",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Email Address * ",-1)),m(e("input",{id:"recipient_email","onUpdate:modelValue":t[4]||(t[4]=o=>r.form.recipient_email=o),type:"email",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter recipient's email"},null,512),[[g,r.form.recipient_email]]),r.errors.recipient_email?(i(),a("p",Se,n(r.errors.recipient_email),1)):h("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{for:"recipient_phone",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Phone Number ",-1)),m(e("input",{id:"recipient_phone","onUpdate:modelValue":t[5]||(t[5]=o=>r.form.recipient_phone=o),type:"tel",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"+971 50 123 4567"},null,512),[[g,r.form.recipient_phone]]),r.errors.recipient_phone?(i(),a("p",Ae,n(r.errors.recipient_phone),1)):h("",!0)]),e("div",null,[t[22]||(t[22]=e("label",{for:"recipient_organization",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Organization ",-1)),m(e("input",{id:"recipient_organization","onUpdate:modelValue":t[6]||(t[6]=o=>r.form.recipient_organization=o),type:"text",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter organization name (optional)"},null,512),[[g,r.form.recipient_organization]]),r.errors.recipient_organization?(i(),a("p",De,n(r.errors.recipient_organization),1)):h("",!0)])]),e("div",Ve,[t[23]||(t[23]=e("label",{for:"delivery_address",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Delivery Address ",-1)),m(e("textarea",{id:"delivery_address","onUpdate:modelValue":t[7]||(t[7]=o=>r.form.delivery_address=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter delivery address (optional)"},null,512),[[g,r.form.delivery_address]]),r.errors.delivery_address?(i(),a("p",ze,n(r.errors.delivery_address),1)):h("",!0)])]),e("div",Ne,[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Dispatch Details",-1)),e("div",Me,[e("div",null,[t[25]||(t[25]=e("label",{for:"issue_date",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Dispatch Date * ",-1)),m(e("input",{id:"issue_date","onUpdate:modelValue":t[8]||(t[8]=o=>r.form.issue_date=o),type:"date",required:"",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"},null,512),[[g,r.form.issue_date]]),r.errors.issue_date?(i(),a("p",Ue,n(r.errors.issue_date),1)):h("",!0)]),e("div",null,[t[26]||(t[26]=e("label",{for:"reference_id",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Reference ID ",-1)),m(e("input",{id:"reference_id","onUpdate:modelValue":t[9]||(t[9]=o=>r.form.reference_id=o),type:"text",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter reference ID (optional)"},null,512),[[g,r.form.reference_id]]),r.errors.reference_id?(i(),a("p",Ee,n(r.errors.reference_id),1)):h("",!0)])]),e("div",Fe,[t[27]||(t[27]=e("label",{for:"notes",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Notes ",-1)),m(e("textarea",{id:"notes","onUpdate:modelValue":t[10]||(t[10]=o=>r.form.notes=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Enter any notes about this gift dispatch (optional)"},null,512),[[g,r.form.notes]]),r.errors.notes?(i(),a("p",Le,n(r.errors.notes),1)):h("",!0)])]),e("div",Pe,[t[32]||(t[32]=e("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Notification Settings",-1)),e("div",qe,[e("div",Re,[t[30]||(t[30]=e("div",null,[e("h3",{class:"text-base font-medium text-charcoal-900"},"Send Email Notification"),e("p",{class:"text-sm text-charcoal-600"},"Send gift details to recipient's email")],-1)),e("label",je,[m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>r.form.send_email=o),type:"checkbox",class:"sr-only peer"},null,512),[[R,r.form.send_email]]),t[29]||(t[29]=e("div",{class:"w-11 h-6 bg-charcoal-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-gray-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-charcoal-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gray-600"},null,-1))])]),r.form.send_email?(i(),a("div",Be,[t[31]||(t[31]=e("label",{for:"email_message",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Custom Message ",-1)),m(e("textarea",{id:"email_message","onUpdate:modelValue":t[12]||(t[12]=o=>r.form.email_message=o),rows:"3",class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",placeholder:"Add a personal message to the email (optional)"},null,512),[[g,r.form.email_message]])])):h("",!0)])]),e("div",Oe,[e("button",{type:"button",onClick:t[13]||(t[13]=o=>_.$router.push("/issues")),class:"px-6 py-2 border border-charcoal-300 text-sm font-medium rounded-lg text-charcoal-700 bg-white hover:bg-charcoal-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:r.loading,class:"px-6 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gray-600 hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[r.loading?(i(),a("span",Xe,[v(I,{class:"w-4 h-4 mr-2 animate-spin"}),t[33]||(t[33]=j(" Creating Dispatch... ",-1))])):(i(),a("span",He,"Dispatch Gift"))],8,Te)])],32)])])}const We=z(Q,[["render",Je],["__scopeId","data-v-d9df519e"]]);export{We as default};
//# sourceMappingURL=IssueCreate-CPxwMNUf.js.map
