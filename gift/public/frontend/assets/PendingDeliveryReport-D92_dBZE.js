var u=(a,e,d)=>new Promise((g,s)=>{var i=y=>{try{c(d.next(y))}catch(r){s(r)}},m=y=>{try{c(d.throw(y))}catch(r){s(r)}},c=y=>y.done?g(y.value):Promise.resolve(y.value).then(i,m);c((d=d.apply(a,e)).next())});import{_ as v,r as D,b as P,d as C,e as h,c as n,o as l,a as t,w as x,v as f,f as p,t as o,g as N,h as I,i as R,j as b,F as k,k as _,n as E,R as w}from"./index-DXfJHqnU.js";import{u as S}from"./useToast-Dqmum05C.js";import{e as T}from"./exportUtils-rTjg8JsQ.js";const V={name:"PendingDeliveryReport",components:{ArrowDownTrayIcon:C,ArrowUpIcon:P,ArrowDownIcon:D},setup(){const{showToast:a}=S();return{showToast:a}},data(){return{loading:!1,isExporting:!1,reportData:[],totalRecords:0,currentPage:1,totalPages:1,pageSize:20,sortBy:"creation",sortOrder:"desc",filters:{giftId:"",giftName:"",personaDetails:""}}},computed:{visiblePages(){const a=[];let d=Math.max(1,this.currentPage-Math.floor(2.5)),g=Math.min(this.totalPages,d+5-1);g-d+1<5&&(d=Math.max(1,g-5+1));for(let s=d;s<=g;s++)a.push(s);return a}},mounted(){this.loadReport()},methods:{loadReport(){return u(this,null,function*(){this.loading=!0;try{const a={page:this.currentPage,limit:this.pageSize,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(a).forEach(d=>{a[d]||delete a[d]});const e=yield w.getPendingDeliveryReport(a);if(e.success)this.reportData=e.data,this.totalRecords=e.total,this.totalPages=e.totalPages;else throw new Error(e.error)}catch(a){console.error("Error loading report:",a),this.showToast("Failed to load report: "+a.message,"error")}finally{this.loading=!1}})},exportReport(){return u(this,null,function*(){this.isExporting=!0;try{const a={limit:1e4,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(a).forEach(g=>{a[g]||delete a[g]});const e=yield w.getPendingDeliveryReport(a);if(!e.success)throw new Error(e.error);const d=[{key:"gift_id",title:"Gift Code"},{key:"gift_name",title:"Gift Name"},{key:"category",title:"Category"},{key:"barcode_value",title:"Barcode"},{key:"gift_value",title:"Gift Value"},{key:"owner_full_name",title:"Owner Name"},{key:"coordinator_full_name",title:"Coordinator Name"},{key:"emirates_id",title:"Emirates ID"},{key:"mobile_number",title:"Mobile Number"},{key:"address",title:"Address"},{key:"dispatch_date",title:"Dispatch Date"},{key:"days_since_dispatch",title:"Days Since Dispatch"},{key:"creator_name",title:"Created By"}];T(e.data,d,"Pending_Delivery_Report"),this.showToast("Report exported successfully","success")}catch(a){console.error("Export error:",a),this.showToast("Failed to export report: "+a.message,"error")}finally{this.isExporting=!1}})},applyFilters(){this.currentPage=1,this.loadReport()},clearFilters(){this.filters={giftId:"",giftName:"",personaDetails:""},this.applyFilters()},toggleSortOrder(){this.sortOrder=this.sortOrder==="asc"?"desc":"asc",this.applyFilters()},goToPage(a){a>=1&&a<=this.totalPages&&(this.currentPage=a,this.loadReport())},formatDate(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}}},F={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},O={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},A={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6"},B={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},G={class:"mt-4 flex justify-between items-center"},U=["disabled"],M={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},j={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},z={class:"flex justify-between items-center"},L={class:"text-lg font-medium text-gray-900 dark:text-white"},q={class:"flex items-center space-x-4"},H=["disabled"],J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Q={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},W={key:0},X={key:1},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm font-medium text-gray-900 dark:text-white"},$={class:"px-6 py-4 whitespace-nowrap"},tt={class:"text-sm font-medium text-gray-900 dark:text-white"},et={class:"text-sm text-gray-500 dark:text-gray-400"},rt={class:"text-xs text-gray-400 dark:text-gray-500"},st={key:0,class:"text-xs text-gray-600 dark:text-gray-400"},at={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900 dark:text-white"},it={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},dt={class:"px-6 py-4 whitespace-nowrap"},lt={class:"text-sm text-gray-900 dark:text-white"},nt={class:"px-6 py-4 whitespace-nowrap"},gt={class:"text-sm text-gray-900 dark:text-white"},yt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},xt={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm font-medium text-gray-900 dark:text-white"},mt={class:"px-6 py-4 whitespace-nowrap"},ut={class:"text-sm text-gray-900 dark:text-white"},ht={class:"text-sm text-gray-500 dark:text-gray-400"},ft={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700"},bt={class:"flex items-center justify-between"},kt={class:"text-sm text-gray-700 dark:text-gray-300"},_t={class:"flex space-x-2"},wt=["disabled"],vt=["onClick"],Dt=["disabled"];function Pt(a,e,d,g,s,i){const m=h("ArrowDownTrayIcon"),c=h("ArrowUpIcon"),y=h("ArrowDownIcon");return l(),n("div",F,[t("div",O,[t("div",A,[e[14]||(e[14]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Search Pending Deliveries",-1)),t("div",B,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Gift ID",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.filters.giftId=r),type:"text",placeholder:"Enter Gift ID...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 dark:bg-gray-700 dark:text-white"},null,512),[[f,s.filters.giftId]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Gift Name",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.filters.giftName=r),type:"text",placeholder:"Enter Gift Name...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 dark:bg-gray-700 dark:text-white"},null,512),[[f,s.filters.giftName]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Persona Details",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.filters.personaDetails=r),type:"text",placeholder:"Name, Emirates ID, Phone...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 dark:bg-gray-700 dark:text-white"},null,512),[[f,s.filters.personaDetails]])])]),t("div",G,[t("button",{onClick:e[3]||(e[3]=(...r)=>i.applyFilters&&i.applyFilters(...r)),disabled:s.loading,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"}," Search ",8,U),t("button",{onClick:e[4]||(e[4]=(...r)=>i.clearFilters&&i.clearFilters(...r)),class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}," Clear Search ")])]),t("div",M,[t("div",j,[t("div",z,[t("h3",L," Pending Deliveries ("+o(s.totalRecords)+" total) ",1),t("div",q,[t("button",{onClick:e[5]||(e[5]=(...r)=>i.exportReport&&i.exportReport(...r)),disabled:s.isExporting||s.reportData.length===0,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"},[N(m,{class:"h-4 w-4 mr-2"}),I(" "+o(s.isExporting?"Exporting...":"Export"),1)],8,H),x(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>s.sortBy=r),onChange:e[7]||(e[7]=(...r)=>i.applyFilters&&i.applyFilters(...r)),class:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white"},[...e[15]||(e[15]=[t("option",{value:"creation"},"Sort by Created Date",-1),t("option",{value:"date"},"Sort by Dispatch Date",-1),t("option",{value:"gift_name"},"Sort by Gift Name",-1),t("option",{value:"owner_full_name"},"Sort by Owner Name",-1)])],544),[[R,s.sortBy]]),t("button",{onClick:e[8]||(e[8]=(...r)=>i.toggleSortOrder&&i.toggleSortOrder(...r)),class:"p-1 rounded text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"},[s.sortOrder==="asc"?(l(),b(c,{key:0,class:"h-4 w-4"})):(l(),b(y,{key:1,class:"h-4 w-4"}))])])])]),t("div",J,[t("table",K,[e[18]||(e[18]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Gift Code"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Gift"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Owner"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Coordinator"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Contact"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Dispatch Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Days Pending"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Created By")])],-1)),t("tbody",Q,[s.loading?(l(),n("tr",W,[...e[16]||(e[16]=[t("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"},[t("div",{class:"flex justify-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"})]),t("div",{class:"mt-2"},"Loading...")],-1)])])):s.reportData.length===0?(l(),n("tr",X,[...e[17]||(e[17]=[t("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"}," No pending deliveries found ",-1)])])):(l(!0),n(k,{key:2},_(s.reportData,r=>(l(),n("tr",{key:r.dispatch_id},[t("td",Y,[t("div",Z,o(r.gift_id||"N/A"),1)]),t("td",$,[t("div",null,[t("div",tt,o(r.gift_name),1),t("div",et,o(r.category),1),t("div",rt,o(r.barcode_value),1),r.gift_value?(l(),n("div",st," Value: "+o(r.gift_value),1)):p("",!0)])]),t("td",at,[t("div",null,[t("div",ot,o(r.owner_full_name),1),r.emirates_id?(l(),n("div",it,o(r.emirates_id),1)):p("",!0)])]),t("td",dt,[t("div",lt,o(r.coordinator_full_name),1)]),t("td",nt,[t("div",null,[t("div",gt,o(r.mobile_number),1),r.address?(l(),n("div",yt,o(r.address),1)):p("",!0)])]),t("td",ct,o(i.formatDate(r.dispatch_date)),1),t("td",xt,[t("div",pt,o(r.days_since_dispatch)+" days",1)]),t("td",mt,[t("div",null,[t("div",ut,o(r.creator_name||"Unknown"),1),t("div",ht,o(i.formatDate(r.created_date)),1)])])]))),128))])])]),s.totalPages>1?(l(),n("div",ft,[t("div",bt,[t("div",kt," Showing "+o((s.currentPage-1)*s.pageSize+1)+" to "+o(Math.min(s.currentPage*s.pageSize,s.totalRecords))+" of "+o(s.totalRecords)+" entries ",1),t("div",_t,[t("button",{onClick:e[9]||(e[9]=r=>i.goToPage(s.currentPage-1)),disabled:s.currentPage===1,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Previous ",8,wt),(l(!0),n(k,null,_(i.visiblePages,r=>(l(),n("button",{key:r,onClick:Ct=>i.goToPage(r),class:E(["px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium",r===s.currentPage?"bg-gray-900 text-white border-gray-900":"text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},o(r),11,vt))),128)),t("button",{onClick:e[10]||(e[10]=r=>i.goToPage(s.currentPage+1)),disabled:s.currentPage===s.totalPages,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Next ",8,Dt)])])])):p("",!0)])])])}const St=v(V,[["render",Pt]]);export{St as default};
//# sourceMappingURL=PendingDeliveryReport-D92_dBZE.js.map
