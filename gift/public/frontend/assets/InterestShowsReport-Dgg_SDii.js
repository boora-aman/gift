var m=(o,e,d)=>new Promise((g,s)=>{var a=c=>{try{y(d.next(c))}catch(r){s(r)}},p=c=>{try{y(d.throw(c))}catch(r){s(r)}},y=c=>c.done?g(c.value):Promise.resolve(c.value).then(a,p);y((d=d.apply(o,e)).next())});import{_ as v,r as D,b as I,d as P,e as u,c as n,o as l,a as t,w as x,v as f,f as h,t as i,g as S,h as C,i as N,j as b,F as _,k as w,n as R,R as k}from"./index-DXfJHqnU.js";import{u as E}from"./useToast-Dqmum05C.js";import{e as T}from"./exportUtils-rTjg8JsQ.js";const F={name:"InterestShowsReport",components:{ArrowDownTrayIcon:P,ArrowUpIcon:I,ArrowDownIcon:D},setup(){const{showToast:o}=E();return{showToast:o}},data(){return{loading:!1,isExporting:!1,reportData:[],totalRecords:0,currentPage:1,totalPages:1,pageSize:20,sortBy:"creation",sortOrder:"desc",filters:{giftId:"",giftName:"",personaDetails:""}}},computed:{visiblePages(){const o=[];let d=Math.max(1,this.currentPage-Math.floor(2.5)),g=Math.min(this.totalPages,d+5-1);g-d+1<5&&(d=Math.max(1,g-5+1));for(let s=d;s<=g;s++)o.push(s);return o}},mounted(){this.loadReport()},methods:{loadReport(){return m(this,null,function*(){this.loading=!0;try{const o={page:this.currentPage,limit:this.pageSize,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(o).forEach(d=>{o[d]||delete o[d]});const e=yield k.getInterestShowsReport(o);if(e.success)this.reportData=e.data,this.totalRecords=e.total,this.totalPages=e.totalPages;else throw new Error(e.error)}catch(o){console.error("Error loading report:",o),this.showToast("Failed to load report: "+o.message,"error")}finally{this.loading=!1}})},exportReport(){return m(this,null,function*(){this.isExporting=!0;try{const o={limit:1e4,order_by:this.sortBy,sort_order:this.sortOrder,gift_id:this.filters.giftId,gift_name:this.filters.giftName,persona_details:this.filters.personaDetails};Object.keys(o).forEach(g=>{o[g]||delete o[g]});const e=yield k.getInterestShowsReport(o);if(!e.success)throw new Error(e.error);const d=[{key:"gift_id",title:"Gift Code"},{key:"gift_name",title:"Gift Name"},{key:"category",title:"Category"},{key:"barcode_value",title:"Barcode"},{key:"owner_full_name",title:"Owner Name"},{key:"coordinator_full_name",title:"Coordinator Name"},{key:"emirates_id",title:"Emirates ID"},{key:"mobile_number",title:"Mobile Number"},{key:"address",title:"Address"},{key:"interest_date",title:"Interest Date"},{key:"creator_name",title:"Created By"},{key:"created_date",title:"Created Date"}];T(e.data,d,"Interest_Shows_Report"),this.showToast("Report exported successfully","success")}catch(o){console.error("Export error:",o),this.showToast("Failed to export report: "+o.message,"error")}finally{this.isExporting=!1}})},applyFilters(){this.currentPage=1,this.loadReport()},clearFilters(){this.filters={giftId:"",giftName:"",personaDetails:""},this.applyFilters()},toggleSortOrder(){this.sortOrder=this.sortOrder==="asc"?"desc":"asc",this.applyFilters()},goToPage(o){o>=1&&o<=this.totalPages&&(this.currentPage=o,this.loadReport())},formatDate(o){return o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}}},O={class:"min-h-screen bg-gray-50"},V={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},A={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},B={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},G={class:"mt-4 flex justify-between items-center"},U=["disabled"],M={class:"bg-white rounded-lg shadow-sm border border-gray-200"},j={class:"px-6 py-4 border-b border-gray-200"},z={class:"flex justify-between items-center"},L={class:"text-lg font-medium text-gray-900 dark:text-white"},q={class:"flex items-center space-x-4"},H=["disabled"],J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Q={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},W={key:0},X={key:1},Y={class:"px-6 py-4 whitespace-nowrap"},Z={class:"text-sm font-medium text-gray-900 dark:text-white"},$={class:"px-6 py-4 whitespace-nowrap"},tt={class:"text-sm font-medium text-gray-900 dark:text-white"},et={class:"text-sm text-gray-500 dark:text-gray-400"},rt={class:"text-xs text-gray-400 dark:text-gray-500"},st={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900 dark:text-white"},at={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},it={class:"px-6 py-4 whitespace-nowrap"},dt={class:"text-sm text-gray-900 dark:text-white"},lt={class:"px-6 py-4 whitespace-nowrap"},nt={class:"text-sm text-gray-900 dark:text-white"},gt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},yt={class:"px-6 py-4 whitespace-nowrap"},xt={class:"text-sm text-gray-900 dark:text-white"},pt={class:"text-sm text-gray-500 dark:text-gray-400"},mt={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700"},ut={class:"flex items-center justify-between"},ft={class:"text-sm text-gray-700 dark:text-gray-300"},ht={class:"flex space-x-2"},bt=["disabled"],_t=["onClick"],wt=["disabled"];function kt(o,e,d,g,s,a){const p=u("ArrowDownTrayIcon"),y=u("ArrowUpIcon"),c=u("ArrowDownIcon");return l(),n("div",O,[t("div",V,[t("div",A,[e[14]||(e[14]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Search Interest Shows",-1)),t("div",B,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Gift ID",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.filters.giftId=r),type:"text",placeholder:"Enter Gift ID...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,s.filters.giftId]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Gift Name",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.filters.giftName=r),type:"text",placeholder:"Enter Gift Name...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,s.filters.giftName]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Persona Details",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.filters.personaDetails=r),type:"text",placeholder:"Name, Emirates ID, Phone...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"},null,512),[[f,s.filters.personaDetails]])])]),t("div",G,[t("button",{onClick:e[3]||(e[3]=(...r)=>a.applyFilters&&a.applyFilters(...r)),disabled:s.loading,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"}," Search ",8,U),t("button",{onClick:e[4]||(e[4]=(...r)=>a.clearFilters&&a.clearFilters(...r)),class:"text-sm text-gray-500 hover:text-gray-700"}," Clear Search ")])]),t("div",M,[t("div",j,[t("div",z,[t("h3",L," Interest Records ("+i(s.totalRecords)+" total) ",1),t("div",q,[t("button",{onClick:e[5]||(e[5]=(...r)=>a.exportReport&&a.exportReport(...r)),disabled:s.isExporting||s.reportData.length===0,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-black disabled:opacity-50"},[S(p,{class:"h-4 w-4 mr-2"}),C(" "+i(s.isExporting?"Exporting...":"Export"),1)],8,H),x(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>s.sortBy=r),onChange:e[7]||(e[7]=(...r)=>a.applyFilters&&a.applyFilters(...r)),class:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white"},[...e[15]||(e[15]=[t("option",{value:"creation"},"Sort by Created Date",-1),t("option",{value:"date"},"Sort by Interest Date",-1),t("option",{value:"gift_name"},"Sort by Gift Name",-1),t("option",{value:"owner_full_name"},"Sort by Owner Name",-1)])],544),[[N,s.sortBy]]),t("button",{onClick:e[8]||(e[8]=(...r)=>a.toggleSortOrder&&a.toggleSortOrder(...r)),class:"p-1 rounded text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"},[s.sortOrder==="asc"?(l(),b(y,{key:0,class:"h-4 w-4"})):(l(),b(c,{key:1,class:"h-4 w-4"}))])])])]),t("div",J,[t("table",K,[e[18]||(e[18]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Gift Code"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Gift"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Owner"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Coordinator"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Contact"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Interest Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Created By")])],-1)),t("tbody",Q,[s.loading?(l(),n("tr",W,[...e[16]||(e[16]=[t("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"},[t("div",{class:"flex justify-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600"})]),t("div",{class:"mt-2"},"Loading...")],-1)])])):s.reportData.length===0?(l(),n("tr",X,[...e[17]||(e[17]=[t("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"}," No interest records found ",-1)])])):(l(!0),n(_,{key:2},w(s.reportData,r=>(l(),n("tr",{key:r.interest_id},[t("td",Y,[t("div",Z,i(r.gift_id||"N/A"),1)]),t("td",$,[t("div",null,[t("div",tt,i(r.gift_name),1),t("div",et,i(r.category),1),t("div",rt,i(r.barcode_value),1)])]),t("td",st,[t("div",null,[t("div",ot,i(r.owner_full_name),1),r.emirates_id?(l(),n("div",at,i(r.emirates_id),1)):h("",!0)])]),t("td",it,[t("div",dt,i(r.coordinator_full_name),1)]),t("td",lt,[t("div",null,[t("div",nt,i(r.mobile_number),1),r.address?(l(),n("div",gt,i(r.address),1)):h("",!0)])]),t("td",ct,i(a.formatDate(r.interest_date)),1),t("td",yt,[t("div",null,[t("div",xt,i(r.creator_name||"Unknown"),1),t("div",pt,i(a.formatDate(r.created_date)),1)])])]))),128))])])]),s.totalPages>1?(l(),n("div",mt,[t("div",ut,[t("div",ft," Showing "+i((s.currentPage-1)*s.pageSize+1)+" to "+i(Math.min(s.currentPage*s.pageSize,s.totalRecords))+" of "+i(s.totalRecords)+" entries ",1),t("div",ht,[t("button",{onClick:e[9]||(e[9]=r=>a.goToPage(s.currentPage-1)),disabled:s.currentPage===1,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Previous ",8,bt),(l(!0),n(_,null,w(a.visiblePages,r=>(l(),n("button",{key:r,onClick:vt=>a.goToPage(r),class:R(["px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium",r===s.currentPage?"bg-gray-900 text-white border-gray-900":"text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},i(r),11,_t))),128)),t("button",{onClick:e[10]||(e[10]=r=>a.goToPage(s.currentPage+1)),disabled:s.currentPage===s.totalPages,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50"}," Next ",8,wt)])])])):h("",!0)])])])}const Ct=v(F,[["render",kt]]);export{Ct as default};
//# sourceMappingURL=InterestShowsReport-Dgg_SDii.js.map
