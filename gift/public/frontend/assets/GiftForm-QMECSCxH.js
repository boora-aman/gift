var R=Object.defineProperty;var S=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var A=(s,t,r)=>t in s?R(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,G=(s,t)=>{for(var r in t||(t={}))X.call(t,r)&&A(s,r,t[r]);if(S)for(var r of S(t))H.call(t,r)&&A(s,r,t[r]);return s};var I=(s,t,r)=>new Promise((e,f)=>{var E=c=>{try{m(r.next(c))}catch(_){f(_)}},h=c=>{try{m(r.throw(c))}catch(_){f(_)}},m=c=>c.done?e(c.value):Promise.resolve(c.value).then(E,h);m((r=r.apply(s,t)).next())});import{_ as J,C as K,q as Q,s as Y,A as Z,u as $,y as ee,p as y,B as V,D as te,z as oe,e as k,c as d,o as l,f as n,a,g as p,t as u,n as ae,h as M,w as x,v,F as re,k as ie,E as le,j as B,H as se,G as de,I as ne}from"./index-DXfJHqnU.js";import{r as ce}from"./PhotoIcon-DBuEETk9.js";import{r as me}from"./TrashIcon-BtZczJiP.js";const be={name:"GiftForm",components:{TrashIcon:me,PhotoIcon:ce,XMarkIcon:Z,ArrowPathIcon:Y,ExclamationTriangleIcon:Q,CustomDropdown:K},props:{initialData:{type:Object,default:()=>({})},isEditMode:{type:Boolean,default:!1},giftStatus:{type:String,default:"Available"}},emits:["submit"],setup(s,{emit:t}){const{showNotification:r}=$(),e=ee({gift_name:"",gift_id:"",gender:"",category:"",description:"",status:"Available",farm_name:"",weight:"",import_barcode:!1,barcode_value:"",gift_additional_attributes:[],gift_images:[]}),f=y({}),E=y(!1),h=y(""),m=y([]),c=y(!1),_=y(null),F=V(()=>!s.isEditMode||s.giftStatus==="Available"),i=V(()=>m.value.map(o=>({value:o.name,label:o.category_name}))),w=[{value:"Male",label:"Male"},{value:"Female",label:"Female"}],U=()=>I(this,null,function*(){try{c.value=!0;const o=yield de.getCategories();if(o.success){const b=o.data||[];m.value=b.map(g=>({name:g.category_name,category_name:g.category_name}))}else console.error("Failed to load categories:",o.error),m.value=[{name:"Watch",category_name:"Watch"},{name:"Mobile",category_name:"Mobile"},{name:"Product",category_name:"Product"},{name:"Service",category_name:"Service"},{name:"Digital",category_name:"Digital"}]}catch(o){console.error("Error loading categories:",o),m.value=[{name:"Watch",category_name:"Watch"},{name:"Mobile",category_name:"Mobile"},{name:"Product",category_name:"Product"},{name:"Service",category_name:"Service"},{name:"Digital",category_name:"Digital"}]}finally{c.value=!1}}),T=()=>{e.gift_additional_attributes.push({attribute_name:"",attribute_value:""})},N=o=>{e.gift_additional_attributes.splice(o,1)},O=o=>I(this,null,function*(){const b=Array.from(o.target.files);for(const g of b)try{const C=yield ne.upload(g);C.success?e.gift_images.push({image:C.data.file_url}):r(`Failed to upload ${g.name}`,"error")}catch(C){console.error("File upload error:",C),r(`Failed to upload ${g.name}`,"error")}o.target.value=""}),W=o=>{e.gift_images.splice(o,1)},q=o=>{if(!o)return"";if(o.startsWith("http://")||o.startsWith("https://"))return o;const g=window.location.origin;return o.startsWith("/files/")?`${g}${o}`:o.startsWith("/")?`${g}${o}`:`${g}/files/${o}`},j=(o,b=!1)=>({available:b?"border-emerald-300":"bg-gray-100 text-gray-800",issued:b?"border-blue-300":"bg-blue-100 text-blue-800",expired:b?"border-red-300":"bg-red-100 text-red-800",cancelled:b?"border-charcoal-300":"bg-charcoal-100 text-charcoal-800",redeemed:b?"border-purple-300":"bg-purple-100 text-purple-800"})[o==null?void 0:o.toLowerCase()]||(b?"border-emerald-300":"bg-gray-100 text-gray-800"),L=o=>({available:"Available",issued:"Issued",expired:"Expired",cancelled:"Cancelled",redeemed:"Redeemed"})[o==null?void 0:o.toLowerCase()]||"Available",D=()=>{var o;return f.value={},e.gift_name.trim()||(f.value.gift_name="Gift name is required"),e.gift_id.trim()||(f.value.gift_id="Gift Code is required"),!s.isEditMode&&e.import_barcode&&!((o=e.barcode_value)!=null&&o.trim())&&(f.value.barcode_value="Barcode ID is required when Import Barcode is checked"),Object.keys(f.value).length===0},P=()=>{if(!D())return;h.value="submit";const o=G({},e);s.isEditMode&&(delete o.import_barcode,delete o.barcode_value),t("submit",o)},z=()=>{h.value=""};return te(()=>s.initialData,o=>{o&&Object.keys(o).length>0&&(e.gift_name=o.gift_name||"",e.gift_id=o.gift_id||"",e.gender=o.gender||"",e.category=o.category||"",e.description=o.description||"",e.status=o.status||"Available",e.farm_name=o.farm_name||"",e.weight=o.weight||"",e.import_barcode=o.import_barcode||!1,e.barcode_value=o.barcode_value||"",e.gift_additional_attributes=o.gift_additional_attributes||[],e.gift_images=o.gift_images||[])},{deep:!0,immediate:!0}),oe(()=>{U()}),{form:e,errors:f,loading:E,saving:h,categories:m,categoriesLoading:c,categoryOptions:i,genderOptions:w,fileInput:_,isFieldEditable:F,addAttribute:T,removeAttribute:N,handleFileUpload:O,removeImage:W,getImageUrl:q,getStatusClasses:j,getStatusText:L,handleSubmit:P,resetSaving:z}}},ge={key:0,class:"bg-amber-50 border border-amber-200 rounded-lg p-4"},fe={class:"flex items-start"},ue={class:"text-sm text-amber-700 mt-1"},he={class:"bg-white rounded-xl shadow-card p-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},xe={key:0},ye=["value"],pe={key:0,class:"mt-1 text-xs text-amber-600"},ve=["disabled"],we={key:0,class:"mt-1 text-sm text-red-600"},ke=["disabled"],Ee={key:0,class:"mt-1 text-sm text-red-600"},Fe={class:"pb-4"},Ce=["disabled"],Ie={key:0,class:"mt-1 text-sm text-red-600"},Me={class:"pb-4"},Ue={key:0,class:"mt-1 text-sm text-red-600"},Se=["disabled"],Ae={key:0,class:"mt-1 text-sm text-red-600"},Ge={class:"mt-6"},Ve=["disabled"],Be={key:0,class:"mt-1 text-sm text-red-600"},Te={class:"bg-white rounded-xl shadow-card p-6"},Ne={class:"flex items-center justify-between mb-6"},Oe=["disabled"],We=["disabled"],qe={key:0,class:"text-center py-8 text-charcoal-500 border-2 border-dashed border-charcoal-200 rounded-lg"},je={class:"mx-auto w-12 h-12 text-charcoal-400 mb-4"},Le={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},De={class:"aspect-square rounded-lg overflow-hidden bg-charcoal-100"},Pe=["src","alt"],ze=["onClick","disabled"],Re={key:1,class:"bg-white rounded-xl shadow-card p-6"},Xe={class:"space-y-4"},He={class:"flex items-center"},Je=["disabled"],Ke={key:0,class:"space-y-2"},Qe=["required","disabled"],Ye={key:0,class:"mt-1 text-sm text-red-600"},Ze={class:"lg:flex lg:justify-end"},$e={class:"hidden lg:block"},et=["disabled"],tt={class:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-charcoal-200 p-4 z-[9999]",style:{"padding-bottom":"max(1rem, env(safe-area-inset-bottom))"}},ot=["disabled"];function at(s,t,r,e,f,E){const h=k("ExclamationTriangleIcon"),m=k("CustomDropdown"),c=k("PhotoIcon"),_=k("XMarkIcon"),F=k("ArrowPathIcon");return l(),d("form",{onSubmit:t[11]||(t[11]=se((...i)=>e.handleSubmit&&e.handleSubmit(...i),["prevent"])),class:"space-y-8 pb-24 lg:pb-0"},[r.isEditMode&&!e.isFieldEditable?(l(),d("div",ge,[a("div",fe,[p(h,{class:"w-5 h-5 text-amber-600 mt-0.5 mr-3 flex-shrink-0"}),a("div",null,[t[12]||(t[12]=a("h3",{class:"text-sm font-medium text-amber-800"},"Gift Cannot Be Modified",-1)),a("p",ue,' This gift cannot be edited because its status is "'+u(e.getStatusText(e.form.status))+'". Only gifts with "Available" status can be modified. ',1)])])])):n("",!0),a("div",he,[t[22]||(t[22]=a("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Basic Information",-1)),a("div",_e,[r.isEditMode?(l(),d("div",xe,[t[14]||(t[14]=a("label",{for:"status",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Status ",-1)),a("input",{id:"status",value:e.getStatusText(e.form.status),type:"text",readonly:"",class:ae(["w-full px-3 py-2 border rounded-lg text-charcoal-900 bg-charcoal-50 cursor-not-allowed",e.getStatusClasses(e.form.status,!0)])},null,10,ye),e.isFieldEditable?n("",!0):(l(),d("p",pe,[p(h,{class:"w-3 h-3 inline mr-1"}),t[13]||(t[13]=M(' Information can only be edited when status is "Available" ',-1))]))])):n("",!0),a("div",null,[t[15]||(t[15]=a("label",{for:"gift_name",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Gift Name * ",-1)),x(a("input",{id:"gift_name","onUpdate:modelValue":t[0]||(t[0]=i=>e.form.gift_name=i),type:"text",required:"",disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter gift name"},null,8,ve),[[v,e.form.gift_name]]),e.errors.gift_name?(l(),d("p",we,u(e.errors.gift_name),1)):n("",!0)]),a("div",null,[t[16]||(t[16]=a("label",{for:"gift_id",class:"block text-sm font-medium text-charcoal-700 mb-2"}," UAE Ring ",-1)),x(a("input",{id:"gift_id","onUpdate:modelValue":t[1]||(t[1]=i=>e.form.gift_id=i),type:"text",disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter UAE Ring"},null,8,ke),[[v,e.form.gift_id]]),e.errors.gift_id?(l(),d("p",Ee,u(e.errors.gift_id),1)):n("",!0)]),a("div",Fe,[t[17]||(t[17]=a("label",{for:"gender",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Gender ",-1)),p(m,{modelValue:e.form.gender,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.gender=i),options:e.genderOptions,placeholder:"Select gender (optional)",disabled:!e.isFieldEditable,"show-badge":!1,label:"gender"},null,8,["modelValue","options","disabled"])]),a("div",null,[t[18]||(t[18]=a("label",{for:"weight",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Weight ",-1)),x(a("input",{id:"weight","onUpdate:modelValue":t[3]||(t[3]=i=>e.form.weight=i),type:"number",step:"0.01",min:"0",disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter weight (optional)"},null,8,Ce),[[v,e.form.weight]]),e.errors.weight?(l(),d("p",Ie,u(e.errors.weight),1)):n("",!0)]),a("div",Me,[t[19]||(t[19]=a("label",{for:"category",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Category ",-1)),p(m,{modelValue:e.form.category,"onUpdate:modelValue":t[4]||(t[4]=i=>e.form.category=i),options:e.categoryOptions,placeholder:"Select category (optional)",disabled:e.categoriesLoading||!e.isFieldEditable,loading:e.categoriesLoading,"show-badge":!1,label:"categories"},null,8,["modelValue","options","disabled","loading"]),e.errors.category?(l(),d("p",Ue,u(e.errors.category),1)):n("",!0)]),a("div",null,[t[20]||(t[20]=a("label",{for:"farm_name",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Farm Name ",-1)),x(a("input",{id:"farm_name","onUpdate:modelValue":t[5]||(t[5]=i=>e.form.farm_name=i),type:"text",disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter farm name (optional)"},null,8,Se),[[v,e.form.farm_name]]),e.errors.farm_name?(l(),d("p",Ae,u(e.errors.farm_name),1)):n("",!0)])]),a("div",Ge,[t[21]||(t[21]=a("label",{for:"description",class:"block text-sm font-medium text-charcoal-700 mb-2"}," Description ",-1)),x(a("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=i=>e.form.description=i),rows:"4",disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter gift description"},null,8,Ve),[[v,e.form.description]]),e.errors.description?(l(),d("p",Be,u(e.errors.description),1)):n("",!0)])]),a("div",Te,[a("div",Ne,[t[23]||(t[23]=a("h2",{class:"text-xl font-semibold text-charcoal-900"},"Images",-1)),a("button",{type:"button",onClick:t[7]||(t[7]=i=>s.$refs.fileInput.click()),disabled:!e.isFieldEditable,class:"px-4 py-2 text-sm font-medium text-gray-800 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-charcoal-50 disabled:text-charcoal-500 disabled:border-charcoal-200"}," Upload Images ",8,Oe)]),a("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",onChange:t[8]||(t[8]=(...i)=>e.handleFileUpload&&e.handleFileUpload(...i)),class:"hidden",disabled:!e.isFieldEditable},null,40,We),e.form.gift_images.length===0?(l(),d("div",qe,[a("div",je,[p(c,{class:"w-full h-full"})]),t[24]||(t[24]=a("p",{class:"text-sm"},"No images uploaded yet.",-1)),t[25]||(t[25]=a("p",{class:"text-xs mt-1"},'Click "Upload Images" to add photos of this gift.',-1))])):(l(),d("div",Le,[(l(!0),d(re,null,ie(e.form.gift_images,(i,w)=>(l(),d("div",{key:w,class:"relative group"},[a("div",De,[a("img",{src:e.getImageUrl(i.image),alt:`Gift image ${w+1}`,class:"w-full h-full object-cover"},null,8,Pe)]),a("button",{type:"button",onClick:U=>e.removeImage(w),disabled:!e.isFieldEditable,class:"absolute top-2 right-2 p-1 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-charcoal-400"},[p(_,{class:"w-4 h-4"})],8,ze)]))),128))]))]),r.isEditMode?n("",!0):(l(),d("div",Re,[t[29]||(t[29]=a("h2",{class:"text-xl font-semibold text-charcoal-900 mb-6"},"Barcode Configuration",-1)),a("div",Xe,[a("div",He,[x(a("input",{id:"import_barcode","onUpdate:modelValue":t[9]||(t[9]=i=>e.form.import_barcode=i),type:"checkbox",disabled:!e.isFieldEditable,class:"h-4 w-4 text-gray-600 focus:ring-gray-500 border-charcoal-300 rounded disabled:opacity-50 disabled:cursor-not-allowed"},null,8,Je),[[le,e.form.import_barcode]]),t[26]||(t[26]=a("label",{for:"import_barcode",class:"ml-2 block text-sm text-charcoal-900"}," Import Barcode ",-1))]),t[28]||(t[28]=a("p",{class:"text-sm text-charcoal-600"}," Check this if you want to specify a custom barcode id. Otherwise, a barcode will be auto-generated. ",-1)),e.form.import_barcode?(l(),d("div",Ke,[t[27]||(t[27]=a("label",{for:"barcode_value",class:"block text-sm font-medium text-charcoal-700"}," Barcode ID * ",-1)),x(a("input",{id:"barcode_value","onUpdate:modelValue":t[10]||(t[10]=i=>e.form.barcode_value=i),type:"text",required:e.form.import_barcode,disabled:!e.isFieldEditable,class:"w-full px-3 py-2 border border-charcoal-300 rounded-lg text-charcoal-900 placeholder-charcoal-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent disabled:bg-charcoal-50 disabled:cursor-not-allowed",placeholder:"Enter barcode ID"},null,8,Qe),[[v,e.form.barcode_value]]),e.errors.barcode_value?(l(),d("p",Ye,u(e.errors.barcode_value),1)):n("",!0)])):n("",!0)])])),a("div",Ze,[a("div",$e,[a("button",{type:"submit",disabled:e.loading||r.isEditMode&&!e.isFieldEditable,class:"px-8 py-3 text-sm font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-charcoal-400"},[e.saving==="submit"?(l(),B(F,{key:0,class:"inline w-4 h-4 mr-2 animate-spin"})):n("",!0),M(" "+u(r.isEditMode?e.saving==="submit"?"Updating Gift...":"Update Gift":e.loading?"Creating Gift...":"Create Gift"),1)],8,et)]),a("div",tt,[a("button",{type:"submit",disabled:e.loading||r.isEditMode&&!e.isFieldEditable,class:"w-full px-8 py-4 text-base font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-charcoal-400 shadow-lg"},[e.saving==="submit"?(l(),B(F,{key:0,class:"inline w-4 h-4 mr-2 animate-spin"})):n("",!0),M(" "+u(r.isEditMode?e.saving==="submit"?"Updating Gift...":"Update Gift":e.loading?"Creating Gift...":"Create Gift"),1)],8,ot)])])],32)}const dt=J(be,[["render",at],["__scopeId","data-v-73e6f923"]]);export{dt as G};
//# sourceMappingURL=GiftForm-QMECSCxH.js.map
